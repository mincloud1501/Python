{"version":3,"sources":["../../../src/worker-utils/get-transfer-list.js"],"names":["getTransferList","object","recursive","transfers","transfersSet","Set","ArrayBuffer","add","buffer","key","undefined","Array","from"],"mappings":";AAEA,eAAe,SAASA,eAAT,CAAyBC,MAAzB,EAA8D;AAAA,MAA7BC,SAA6B,uEAAjB,IAAiB;AAAA,MAAXC,SAAW;AAE3E,MAAMC,YAAY,GAAGD,SAAS,IAAI,IAAIE,GAAJ,EAAlC;;AAEA,MAAI,CAACJ,MAAL,EAAa,CAEZ,CAFD,MAEO,IAAIA,MAAM,YAAYK,WAAtB,EAAmC;AACxCF,IAAAA,YAAY,CAACG,GAAb,CAAiBN,MAAjB;AACD,GAFM,MAEA,IAAIA,MAAM,CAACO,MAAP,IAAiBP,MAAM,CAACO,MAAP,YAAyBF,WAA9C,EAA2D;AAEhEF,IAAAA,YAAY,CAACG,GAAb,CAAiBN,MAAM,CAACO,MAAxB;AACD,GAHM,MAGA,IAAIN,SAAS,IAAI,QAAOD,MAAP,MAAkB,QAAnC,EAA6C;AAClD,SAAK,IAAMQ,GAAX,IAAkBR,MAAlB,EAA0B;AAExBD,MAAAA,eAAe,CAACC,MAAM,CAACQ,GAAD,CAAP,EAAcP,SAAd,EAAyBE,YAAzB,CAAf;AACD;AACF;;AAID,SAAOD,SAAS,KAAKO,SAAd,GAA0BC,KAAK,CAACC,IAAN,CAAWR,YAAX,CAA1B,GAAqD,IAA5D;AACD","sourcesContent":["// Returns an array of Transferrable objects that can be used with\n// postMessage: https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage\nexport default function getTransferList(object, recursive = true, transfers) {\n  // Make sure that items in the transfer list is unique\n  const transfersSet = transfers || new Set();\n\n  if (!object) {\n    // ignore\n  } else if (object instanceof ArrayBuffer) {\n    transfersSet.add(object);\n  } else if (object.buffer && object.buffer instanceof ArrayBuffer) {\n    // Typed array\n    transfersSet.add(object.buffer);\n  } else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      // Avoid perf hit - only go one level deep\n      getTransferList(object[key], recursive, transfersSet);\n    }\n  }\n\n  // If transfers is defined, is internal recursive call\n  // Otherwise it's called by the user\n  return transfers === undefined ? Array.from(transfersSet) : null;\n}\n"],"file":"get-transfer-list.js"}