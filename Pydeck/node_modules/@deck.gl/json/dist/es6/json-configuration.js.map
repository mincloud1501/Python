{"version":3,"sources":["../../src/json-configuration.js"],"names":["parseExpressionString","assert","DEFAULT_TYPE_KEY","isObject","value","JSONConfiguration","constructor","configurations","typeKey","log","console","classes","reactComponents","enumerations","constants","convertFunction","preProcessClassProps","Class","props","postProcessConvertedJson","json","configuration","_merge","key","Object","assign","validate","startsWith","isAccessor"],"mappings":"AACA,OAAOA,qBAAP,MAAkC,mCAAlC;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AAEA,MAAMC,gBAAgB,GAAG,MAAzB;;AAEA,MAAMC,QAAQ,GAAGC,KAAK,IAAIA,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAApD;;AAEA,eAAe,MAAMC,iBAAN,CAAwB;AACrCC,EAAAA,WAAW,CAAC,GAAGC,cAAJ,EAAoB;AAE7B,SAAKC,OAAL,GAAeN,gBAAf;AACA,SAAKO,GAAL,GAAWC,OAAX;AACA,SAAKC,OAAL,GAAe,EAAf;AACA,SAAKC,eAAL,GAAuB,EAAvB;AACA,SAAKC,YAAL,GAAoB,EAApB;AACA,SAAKC,SAAL,GAAiB,EAAjB;AAEA,SAAKC,eAAL,GAAuBA,eAAvB;;AACA,SAAKC,oBAAL,GAA4B,CAACC,KAAD,EAAQC,KAAR,KAAkBA,KAA9C;;AACA,SAAKC,wBAAL,GAAgCC,IAAI,IAAIA,IAAxC;;AAEA,SAAK,MAAMC,aAAX,IAA4Bd,cAA5B,EAA4C;AAC1C,WAAKe,MAAL,CAAYD,aAAZ;AACD;AACF;;AAEDC,EAAAA,MAAM,CAACD,aAAD,EAAgB;AACpB,SAAK,MAAME,GAAX,IAAkBF,aAAlB,EAAiC;AAC/B,cAAQE,GAAR;AAEE,aAAK,QAAL;AACA,aAAK,OAAL;AACEC,UAAAA,MAAM,CAACC,MAAP,CAAc,KAAKd,OAAnB,EAA4BU,aAAa,CAACE,GAAD,CAAzC;AACA;;AACF;AAEE,cAAIA,GAAG,IAAI,IAAX,EAAiB;AACf,kBAAMnB,KAAK,GAAGiB,aAAa,CAACE,GAAD,CAA3B;AACA,iBAAKA,GAAL,IAAYpB,QAAQ,CAAC,KAAKoB,GAAL,CAAD,CAAR,GAAsBC,MAAM,CAACC,MAAP,CAAc,KAAKF,GAAL,CAAd,EAAyBnB,KAAzB,CAAtB,GAAwDA,KAApE;AACD;;AAXL;AAaD;AACF;;AAEDsB,EAAAA,QAAQ,CAACL,aAAD,EAAgB;AACtBpB,IAAAA,MAAM,CAAC,CAAC,KAAKO,OAAN,IAAiB,OAAO,KAAKA,OAAZ,KAAwB,QAA1C,CAAN;AACAP,IAAAA,MAAM,CAACE,QAAQ,CAAC,KAAKQ,OAAN,CAAT,CAAN;AACA,WAAO,IAAP;AACD;;AAzCoC;;AA4CvC,SAASI,eAAT,CAAyBX,KAAzB,EAAgCmB,GAAhC,EAAqCF,aAArC,EAAoD;AAClD,MAAIE,GAAG,CAACI,UAAJ,CAAe,KAAf,CAAJ,EAA2B;AACzB,UAAMC,UAAU,GAAG,IAAnB;AACA,WAAO5B,qBAAqB,CAACI,KAAD,EAAQiB,aAAR,EAAuBO,UAAvB,CAA5B;AACD;;AACD,SAAOxB,KAAP;AACD","sourcesContent":["// TODO - default parsing code should not be part of the configuration.\nimport parseExpressionString from './helpers/parse-expression-string';\nimport assert from './utils/assert';\n\nconst DEFAULT_TYPE_KEY = 'type';\n\nconst isObject = value => value && typeof value === 'object';\n\nexport default class JSONConfiguration {\n  constructor(...configurations) {\n    // Initialize config with default values\n    this.typeKey = DEFAULT_TYPE_KEY;\n    this.log = console; // eslint-disable-line\n    this.classes = {};\n    this.reactComponents = {};\n    this.enumerations = {};\n    this.constants = {};\n    // TODO - this needs to be simpler, function conversion should be built in\n    this.convertFunction = convertFunction;\n    this.preProcessClassProps = (Class, props) => props;\n    this.postProcessConvertedJson = json => json;\n\n    for (const configuration of configurations) {\n      this._merge(configuration);\n    }\n  }\n\n  _merge(configuration) {\n    for (const key in configuration) {\n      switch (key) {\n        // DEPRECATED = For backwards compatibility, add views and layers to classes;\n        case 'layers':\n        case 'views':\n          Object.assign(this.classes, configuration[key]);\n          break;\n        default:\n          // Store configuration as root fields (this.classes, ...)\n          if (key in this) {\n            const value = configuration[key];\n            this[key] = isObject(this[key]) ? Object.assign(this[key], value) : value;\n          }\n      }\n    }\n  }\n\n  validate(configuration) {\n    assert(!this.typeKey || typeof this.typeKey === 'string');\n    assert(isObject(this.classes));\n    return true;\n  }\n}\n\nfunction convertFunction(value, key, configuration) {\n  if (key.startsWith('get')) {\n    const isAccessor = true;\n    return parseExpressionString(value, configuration, isAccessor);\n  }\n  return value;\n}\n"],"file":"json-configuration.js"}