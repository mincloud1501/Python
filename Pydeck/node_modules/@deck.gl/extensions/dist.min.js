!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("deck"),require("luma"));else if("function"==typeof define&&define.amd)define(["deck","luma"],n);else{var t="object"==typeof exports?n(require("deck"),require("luma")):n(e.deck,e.luma);for(var r in t)("object"==typeof exports?exports:e)[r]=t[r]}}(window,(function(e,n){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=7)}([function(n,t){n.exports=e},function(e,t){e.exports=n},function(e,n){e.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}},function(e,n){function t(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}},function(e,n,t){var r=t(9),i=t(10);e.exports=function(e,n){return!n||"object"!==r(n)&&"function"!=typeof n?i(e):n}},function(e,n){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(n)}e.exports=t},function(e,n,t){var r=t(11);e.exports=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&r(e,n)}},function(e,n,t){(function(n){const r=t(12),i=("undefined"==typeof window?n:window).deck||{};if(!i.Layer)throw new Error("@deck.gl/core is not found");e.exports=Object.assign(i,r)}).call(this,t(8))},function(e,n){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,n){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(n){return"function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?e.exports=r=function(e){return t(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},r(n)}e.exports=r},function(e,n){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,n){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},t(n,r)}e.exports=t},function(e,n,t){"use strict";t.r(n);var r=t(2),i=t.n(r),o=t(3),u=t.n(o),a=t(4),s=t.n(a),l=t(5),f=t.n(l),c=t(6),d=t.n(c),b=t(0),g=t(1),p={source:0,target:1,custom:2};Object(g.createModuleInjection)("brushing",{hook:"vs:DECKGL_FILTER_GL_POSITION",injection:"\nvec2 brushingTarget;\nif (brushing_target == 0) {\n  brushingTarget = geometry.worldPosition.xy;\n} else if (brushing_target == 1) {\n  brushingTarget = geometry.worldPositionAlt.xy;\n} else {\n  #ifdef NON_INSTANCED_MODEL\n  brushingTarget = brushingTargets;\n  #else\n  brushingTarget = instanceBrushingTargets;\n  #endif\n}\nbrushing_setVisible(brushing_isPointInRange(brushingTarget));\n  "}),Object(g.createModuleInjection)("brushing",{hook:"fs:DECKGL_FILTER_COLOR",injection:"\nif (brushing_enabled && brushing_isVisible < 0.5) {\n  discard;\n}\n  "});var _={name:"brushing",dependencies:["project"],vs:"\n  uniform bool brushing_enabled;\n  uniform int brushing_target;\n  uniform vec2 brushing_mousePos;\n  uniform float brushing_radius;\n\n  #ifdef NON_INSTANCED_MODEL\n  attribute vec2 brushingTargets;\n  #else\n  attribute vec2 instanceBrushingTargets;\n  #endif\n\n  varying float brushing_isVisible;\n\n  bool brushing_isPointInRange(vec2 position) {\n    if (!brushing_enabled) {\n      return true;\n    }\n    vec2 source_commonspace = project_position(position);\n    vec2 target_commonspace = project_position(brushing_mousePos);\n    float distance = length((target_commonspace - source_commonspace) / project_uCommonUnitsPerMeter.xy);\n\n    return distance <= brushing_radius;\n  }\n\n  void brushing_setVisible(bool visible) {\n    brushing_isVisible = float(visible);\n  }\n",fs:"\n  uniform bool brushing_enabled;\n  varying float brushing_isVisible;\n",getUniforms:function(e){if(!e||!e.viewport)return{};var n=e.brushingEnabled,t=void 0===n||n,r=e.brushingRadius,i=void 0===r?1e4:r,o=e.brushingTarget,u=void 0===o?"source":o,a=e.mousePosition,s=e.viewport;return{brushing_enabled:Boolean(t&&a&&s.containsPixel(a)),brushing_radius:i,brushing_target:p[u]||0,brushing_mousePos:a?s.unproject([a.x-s.x,a.y-s.y]):[0,0]}}},v=function(e){function n(){return i()(this,n),s()(this,f()(n).apply(this,arguments))}return d()(n,e),u()(n,[{key:"getShaders",value:function(e){return{modules:[_]}}},{key:"initializeState",value:function(e,n){var t=this,r=this.getAttributeManager();r&&r.add({brushingTargets:{size:2,accessor:"getBrushingTarget",update:!this.props.getBrushingTarget&&n.useConstantTargetPositions,shaderAttributes:{brushingTargets:{divisor:0},instanceBrushingTargets:{divisor:1}}}}),n.onMouseMove=function(){t.getCurrentLayer().setNeedsRedraw()},this.context.deck&&this.context.deck.eventManager.on({pointermove:n.onMouseMove,pointerleave:n.onMouseMove})}},{key:"finalizeState",value:function(e){this.context.deck&&this.context.deck.eventManager.off({pointermove:e.onMouseMove,pointerleave:e.onMouseMove})}},{key:"useConstantTargetPositions",value:function(e){e.constant=!0,e.value=new Float32Array(2)}}]),n}(b.LayerExtension);v.extensionName="BrushingExtension",v.defaultProps={getBrushingTarget:{type:"accessor",value:[0,0]},brushingTarget:"source",brushingEnabled:!0,brushingRadius:1e4};Object(g.createModuleInjection)("data-filter",{hook:"vs:#main-start",injection:"\n#ifdef NON_INSTANCED_MODEL\ndataFilter_setValue(filterValues);\n#else\ndataFilter_setValue(instanceFilterValues);\n#endif\n  "}),Object(g.createModuleInjection)("data-filter",{hook:"vs:DECKGL_FILTER_SIZE",injection:"\nif (filter_transformSize) {\n  size = size * dataFilter_value;\n}\n  "}),Object(g.createModuleInjection)("data-filter",{hook:"fs:DECKGL_FILTER_COLOR",injection:"\nif (dataFilter_value == 0.0) discard;\nif (filter_transformColor) {\n  color.a *= dataFilter_value;\n}\n  "});var m={name:"data-filter",vs:"\nuniform DATAFILTER_TYPE filter_min;\nuniform DATAFILTER_TYPE filter_softMin;\nuniform DATAFILTER_TYPE filter_softMax;\nuniform DATAFILTER_TYPE filter_max;\nuniform bool filter_useSoftMargin;\nuniform bool filter_enabled;\nuniform bool filter_transformSize;\n\n#ifdef NON_INSTANCED_MODEL\nattribute DATAFILTER_TYPE filterValues;\n#else\nattribute DATAFILTER_TYPE instanceFilterValues;\n#endif\n\nvarying float dataFilter_value;\n\nfloat dataFilter_reduceValue(float value) {\n  return value;\n}\nfloat dataFilter_reduceValue(vec2 value) {\n  return min(value.x, value.y);\n}\nfloat dataFilter_reduceValue(vec3 value) {\n  return min(min(value.x, value.y), value.z);\n}\nfloat dataFilter_reduceValue(vec4 value) {\n  return min(min(value.x, value.y), min(value.z, value.w));\n}\nvoid dataFilter_setValue(DATAFILTER_TYPE value) {\n  if (filter_enabled) {\n    if (filter_useSoftMargin) {\n      dataFilter_value = dataFilter_reduceValue(\n        smoothstep(filter_min, filter_softMin, value) *\n        (1.0 - smoothstep(filter_softMax, filter_max, value))\n      );\n    } else {\n      dataFilter_value = dataFilter_reduceValue(\n        step(filter_min, value) * step(value, filter_max)\n      );\n    }\n  } else {\n    dataFilter_value = 1.0;\n  }\n}\n",fs:"\nuniform bool filter_transformColor;\nvarying float dataFilter_value;\n",getUniforms:function(e){if(!e||!e.extensions)return{};var n=e.filterRange,t=void 0===n?[-1,1]:n,r=e.filterEnabled,i=void 0===r||r,o=e.filterTransformSize,u=void 0===o||o,a=e.filterTransformColor,s=void 0===a||a,l=e.filterSoftRange||t,f=Number.isFinite(t[0])?{filter_min:t[0],filter_softMin:l[0],filter_softMax:l[1],filter_max:t[1]}:{filter_min:t.map((function(e){return e[0]})),filter_softMin:l.map((function(e){return e[0]})),filter_softMax:l.map((function(e){return e[1]})),filter_max:t.map((function(e){return e[1]}))};return f.filter_enabled=i,f.filter_useSoftMargin=Boolean(e.filterSoftRange),f.filter_transformSize=i&&u,f.filter_transformColor=i&&s,f}},h={1:"float",2:"vec2",3:"vec3",4:"vec4"},y=function(e){function n(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).filterSize,t=void 0===e?1:e;if(i()(this,n),!h[t])throw new Error("filterSize out of range");return s()(this,f()(n).call(this,{filterSize:t}))}return d()(n,e),u()(n,[{key:"getShaders",value:function(e){var n=e.opts.filterSize;return{modules:[m],defines:{DATAFILTER_TYPE:h[n]}}}},{key:"initializeState",value:function(e,n){var t=this.getAttributeManager();t&&t.add({filterValues:{size:n.opts.filterSize,accessor:"getFilterValue",shaderAttributes:{filterValues:{divisor:0},instanceFilterValues:{divisor:1}}}})}}]),n}(b.LayerExtension);y.extensionName="DataFilterExtension",y.defaultProps={getFilterValue:{type:"accessor",value:0},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterTransformSize:!0,filterTransformColor:!0};var T=function(e){function n(){return i()(this,n),s()(this,f()(n).apply(this,arguments))}return d()(n,e),u()(n,[{key:"getShaders",value:function(e){if(this.props.coordinateSystem!==b.COORDINATE_SYSTEM.LNGLAT_DEPRECATED)throw new Error("fp64: coordinateSystem must be LNGLAT_DEPRECATED");return{modules:[b.project64]}}}]),n}(b.LayerExtension);T.extensionName="Fp64Extension",t.d(n,"BrushingExtension",(function(){return v})),t.d(n,"DataFilterExtension",(function(){return y})),t.d(n,"Fp64Extension",(function(){return T}))}])}));