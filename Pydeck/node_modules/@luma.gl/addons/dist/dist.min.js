!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("luma"));else if("function"==typeof define&&define.amd)define(["luma"],t);else{var r="object"==typeof exports?t(require("luma")):t(e.luma);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=13)}([function(e,t,r){e.exports=r(20)},function(t,r){t.exports=e},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}r.d(t,"a",function(){return i})},function(e,t){e.exports={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},function(e,t,r){"use strict";(function(e,n){r.d(t,"b",function(){return s}),r.d(t,"a",function(){return a}),r.d(t,"c",function(){return c});var i=r(2),s="object"!==(void 0===e?"undefined":Object(i.a)(e))||"[object process]"!==String(e)||e.browser,o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n&&n,document:"undefined"!=typeof document&&document},a=o.global||o.self||o.window,u=void 0!==e&&e.version&&e.version.match(/v([0-9]*)/),c=u&&parseFloat(u[1])||0}).call(this,r(12),r(8))},,function(e,t,r){"use strict";(function(e,n){r.d(t,"a",function(){return o});var i=r(2),s=("object"!==(void 0===e?"undefined":Object(i.a)(e))||"[object process]"!==String(e)||e.browser,{self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n&&n}),o=s.global||s.self||s.window}).call(this,r(12),r(8))},,function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},,,,function(e,t){var r,n,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,c=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&E())}function E(){if(!f){var e=a(h);f=!0;for(var t=c.length;t;){for(u=c,c=[];++l<t;)u&&u[l].run();l=-1,t=c.length}u=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new _(e,t)),1!==c.length||f||a(E)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){(function(t){const n=r(21),i="undefined"==typeof window?t:window;i.loaders=i.luma||{},e.exports=Object.assign(i.luma,n)}).call(this,r(8))},,,,,,,function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,s=Object.create(i.prototype),o=new N(n||[]);return s._invoke=function(e,t,r){var n=f;return function(i,s){if(n===h)throw new Error("Generator is already running");if(n===E){if("throw"===i)throw s;return I()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=b(o,r);if(a){if(a===_)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=E,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var u=c(e,t,r);if("normal"===u.type){if(n=r.done?E:l,u.arg===_)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=E,r.method="throw",r.arg=u.arg)}}}(e,r,o),s}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var f="suspendedStart",l="suspendedYield",h="executing",E="completed",_={};function v(){}function T(){}function p(){}var y={};y[s]=function(){return this};var A=Object.getPrototypeOf,R=A&&A(A(M([])));R&&R!==r&&n.call(R,s)&&(y=R);var d=p.prototype=v.prototype=Object.create(y);function g(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function m(e){var t;this._invoke=function(r,i){function s(){return new Promise(function(t,s){!function t(r,i,s,o){var a=c(e[r],e,i);if("throw"!==a.type){var u=a.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?Promise.resolve(f.__await).then(function(e){t("next",e,s,o)},function(e){t("throw",e,s,o)}):Promise.resolve(f).then(function(e){u.value=e,s(u)},function(e){return t("throw",e,s,o)})}o(a.arg)}(r,i,t,s)})}return t=t?t.then(s,s):s()}}function b(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,b(e,r),"throw"===r.method))return _;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var i=c(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var s=i.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function M(e){if(e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:I}}function I(){return{value:t,done:!0}}return T.prototype=d.constructor=p,p.constructor=T,p[a]=T.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(d),e},e.awrap=function(e){return{__await:e}},g(m.prototype),m.prototype[o]=function(){return this},e.AsyncIterator=m,e.async=function(t,r,n,i){var s=new m(u(t,r,n,i));return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},g(d),d[a]="Generator",d[s]=function(){return this},d.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=M,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){"use strict";r.r(t);var n=r(1);class i{getViews(e){const{width:t,height:r}=e;return[{params:{viewport:[0,0,t,r],scissor:[0,0,t,r],scissorTest:!0}}]}submitFrame(){return!0}requestAnimationFrame(e){return!1}delete(){}_renderFrame(e){const t=this.getViews(e);if(!t)return!1;const{gl:r}=this.animationLoop;for(const i of t)Object(n.withParameters)(r,i.params,()=>this.animationLoop.onRender({...e,...i}));return this.submitFrame(),!0}}class s extends i{static isSupported(){return"undefined"!=typeof navigator&&"getVRDisplays"in navigator&&"VRFrameData"in window}constructor(e){super(e),this._vrSupported=s.isSupported(),this._vrSupported&&(this.vrFrameData=new window.VRFrameData,this.vrPresenting=!1,this.vrFrame=!1,window.addEventListener("vrdisplaypresentchange",this._vrDisplayPresentChange.bind(this)))}delete(){super.delete(),this._removeVRButton()}getViews(e){if(this._vrSupported&&this._addVRButton(),this.vrPresenting&&this.vrFrame){this.vrDisplay.getFrameData(this.vrFrameData);const{leftProjectionMatrix:t,leftViewMatrix:r,rightProjectionMatrix:n,rightViewMatrix:i}=this.vrFrameData,{width:s,height:o}=e;return[{displayEye:"left",projectionMatrix:t,viewMatrix:r,params:{viewport:[0,0,.5*s,o],scissor:[0,0,.5*s,o],scissorTest:!0}},{displayEye:"right",projectionMatrix:n,viewMatrix:i,params:{viewport:[.5*s,0,.5*s,o],scissor:[.5*s,0,.5*s,o],scissorTest:!0}}]}return super.getViews(e)}submitFrame(){return!(!this.vrPresenting||!this.vrFrame)&&(this.vrDisplay.submitFrame(),!0)}requestAnimationFrame(e){return!!this.vrPresenting&&(this.vrDisplay.requestAnimationFrame(()=>{this.vrFrame=!0,e(),this.vrFrame=!1}),!0)}async _addVRButton(){if(this.vrButton)return;const e=this._getCanvas();if(!e)return;const t=await navigator.getVRDisplays();t&&t.length&&(n.log.info(2,"Found VR Displays",t)(),this.vrDisplay=t[0],this.vrButton=function({canvas:e,title:t}){const{top:r,left:n,width:i,height:s}=e.getBoundingClientRect(),o=document.createElement("div");o.style.position="absolute",o.style.top=`${r}px`,o.style.left=`${n}px`,o.style.width=`${i}px`,o.style.height=`${s}px`,o.style.pointerEvents="none",o.style.zIndex="999",document.body.appendChild(o);const a=document.createElement("button");return a.style.padding="16px",a.style.border="1px solid #fff",a.style.borderRadius="8px",a.style.background="rgba(0,0,0,0.5)",a.style.color="#fff",a.style.font="normal 20px sans-serif",a.style.cursor="pointer",a.style.margin="20px auto",a.style.display="block",a.style.pointerEvents="all",a.textContent=t,o.appendChild(a),a}({canvas:e,title:`Enter VR (${this.vrDisplay.displayName})`}),this.vrButton.onclick=()=>this._startDisplay())}_getCanvas(){return this.animationLoop.canvas||this.animationLoop.gl&&this.animationLoop.gl.canvas}_removeVRButton(){this.vrButton}_startDisplay(){this.vrDisplay.requestPresent([{source:this._getCanvas()}])}_vrDisplayPresentChange(){this.vrDisplay.isPresenting?(n.log.info(2,"Entering VR")(),this.vrPresenting=!0,this.vrButton.style.display="none"):(n.log.info(2,"Exiting VR")(),this.vrPresenting=!1,this.vrButton.style.display="block")}}var o=r(0),a=r.n(o);function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){c(s,n,i,o,a,"next",e)}function a(e){c(s,n,i,o,a,"throw",e)}o(void 0)})}}var l=r(2),h=function(e){return"undefined"!=typeof Response&&e instanceof Response||e.arrayBuffer&&e.text&&e.json},E=function(e){return function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)},_="",v={};function T(e){for(var t in v)if(e.startsWith(t)){var r=v[t];return e.replace(t,r)}return e+=_}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),e}function R(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var d=function(){function e(t){p(this,e),this._fileOrBlob=t,this.bodyUsed=!1}return A(e,[{key:"url",value:function(){return this._fileOrBlob.name||""}},{key:"arrayBuffer",value:function(){var e=f(a.a.mark(function e(){var t,r,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._getFileReader(),r=t.reader,n=t.promise,r.readAsArrayBuffer(this._fileOrBlob),e.abrupt("return",n);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"text",value:function(){var e=f(a.a.mark(function e(){var t,r,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._getFileReader(),r=t.reader,n=t.promise,r.readAsText(this._fileOrBlob),e.abrupt("return",n);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"json",value:function(){var e=f(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.text();case 2:return t=e.sent,e.abrupt("return",JSON.parse(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_getFileReader",value:function(){var e;R(!this.bodyUsed),this.bodyUsed=!0;var t=new Promise(function(t,r){try{(e=new FileReader).onerror=function(e){return r(new Error(e))},e.onabort=function(){return r(new Error("Read aborted."))},e.onload=function(){return t(e.result)}}catch(e){r(e)}});return{reader:e,promise:t}}},{key:"headers",get:function(){return new Headers({"Content-Length":this._fileOrBlob.size,"Content-Type":this._fileOrBlob.type})}},{key:"ok",get:function(){return!0}},{key:"status",get:function(){return 200}}]),e}();function g(e,t){return Promise.resolve(new d(e,t))}function m(e,t){return b.apply(this,arguments)}function b(){return(b=f(a.a.mark(function e(t,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!E(t)){e.next=2;break}return e.abrupt("return",g(t,r));case 2:return t=T(t),e.abrupt("return",fetch(t,r));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(e,t){if(!e)throw new Error(t||"gltf/glb assertion failed.")}var S=["SCALAR","VEC2","VEC3","VEC4"],N=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),M={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},I={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},L={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function w(e){return S[e-1]||S[0]}function C(e){var t=N.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function F(e,t){var r=L[e.componentType],n=M[e.type],i=I[e.componentType],s=e.count*n,o=e.count*n*i;return O(o>=0&&o<=t.byteLength),{ArrayType:r,length:s,byteLength:o}}function B(e,t){return e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:")?e:t.substr(0,t.lastIndexOf("/")+1)+e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var k=!1,U=!0,P=new Map([["image/png",{test:function(e){return e.byteLength>=24&&2303741511===e.getUint32(0,k)},getSize:function(e){return{width:e.getUint32(16,k),height:e.getUint32(20,k)}}}],["image/jpeg",{test:function(e){return e.byteLength>=3&&65496===e.getUint16(0,k)&&255===e.getUint8(2,k)},getSize:function(e){if(e.byteLength<2||65496!==e.getUint16(0,k))return null;var t=function(){for(var e=new Set([65499,65476,65484,65501,65534]),t=65504;t<65520;++t)e.add(t);var r=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:r}}(),r=t.tableMarkers,n=t.sofMarkers,i=2;for(;i<e.byteLength;){var s=e.getUint16(i,k);if(n.has(s))return{height:e.getUint16(i+5,k),width:e.getUint16(i+7,k)};if(!r.has(s))return null;i+=2,i+=e.getUint16(i,k)}return null}}],["image/gif",{test:function(e){return e.byteLength>=10&&1195984440===e.getUint32(0,k)},getSize:function(e){return{width:e.getUint16(6,U),height:e.getUint16(8,U)}}}],["image/bmp",{test:function(e){return e.byteLength>=2&&16973===e.getUint16(0,k)},getSize:function(e){return{width:e.getUint32(18,U),height:e.getUint32(22,U)}}}]]);var D="Invalid MIME type. Supported MIME types are: ".concat(Array.from(P.keys()).join(", "));function G(e){var t=X(e),r=!0,n=!1,i=void 0;try{for(var s,o=P.entries()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=x(s.value,2),u=a[0];if((0,a[1].test)(t))return u}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(0,V(t=t||G(e)).getSize)(X(e));if(!r)throw new Error("invalid image data for type: ".concat(t));return r}(e,t=t||G(e));return r.mimeType=t,r}function V(e){var t=P.get(e);if(!t)throw new Error(D);return t}function X(e){if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))return new DataView(e.buffer||e);throw new Error("toDataView")}function H(e){return e+3&-4}function W(e,t,r){var n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{var i=e.byteOffset,s=e.byteLength;n=new Uint8Array(e.buffer,i,s)}return t.set(n,r),r+H(n.byteLength)}var K=function(){function e(t){if(p(this,e),t instanceof e)return t;t||(t={json:{version:2,buffers:[]},buffers:[]}),this.gltf=t,O(this.gltf.json)}return A(e,[{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getExtraData",value:function(e){return(this.json.extras||{})[e]}},{key:"getExtension",value:function(e){var t=this.getUsedExtensions().find(function(t){return t===e}),r=this.json.extensions||{};return t?r[e]||!0:null}},{key:"getRequiredExtension",value:function(e){return this.getRequiredExtensions().find(function(t){return t===e})?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(e,t){return(e.extensions||{})[t]}},{key:"getScene",value:function(e){return this.getObject("scenes",e)}},{key:"getNode",value:function(e){return this.getObject("nodes",e)}},{key:"getSkin",value:function(e){return this.getObject("skins",e)}},{key:"getMesh",value:function(e){return this.getObject("meshes",e)}},{key:"getMaterial",value:function(e){return this.getObject("materials",e)}},{key:"getAccessor",value:function(e){return this.getObject("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this.getObject("textures",e)}},{key:"getSampler",value:function(e){return this.getObject("samplers",e)}},{key:"getImage",value:function(e){return this.getObject("images",e)}},{key:"getBufferView",value:function(e){return this.getObject("bufferViews",e)}},{key:"getBuffer",value:function(e){return this.getObject("buffers",e)}},{key:"getObject",value:function(e,t){if("object"===Object(l.a)(t))return t;var r=this.json[e]&&this.json[e][t];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return r}},{key:"getTypedArrayForBufferView",value:function(e){var t=(e=this.getBufferView(e)).buffer,r=this.gltf.buffers[t];O(r);var n=e.byteOffset||0+r.byteOffset;return new Uint8Array(r.arrayBuffer,n,e.byteLength)}},{key:"getTypedArrayForAccessor",value:function(e){e=this.getAccessor(e);var t=this.getBuffer(e.bufferView),r=this.getBuffer(t.buffer).data,n=F(e,t),i=n.ArrayType,s=n.length;return new i(r,t.byteOffset+e.byteOffset,s)}},{key:"getTypedArrayForImageData",value:function(e){e=this.getAccessor(e);var t=this.getBuffer(e.bufferView),r=this.getBuffer(t.buffer).data,n=t.byteOffset||0;return new Uint8Array(r,n,t.byteLength)}},{key:"addApplicationData",value:function(e,t){return this.json[e]=t,this}},{key:"addExtraData",value:function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}},{key:"addExtension",value:function(e,t){return O(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),this}},{key:"addRequiredExtension",value:function(e,t){return O(t),this.addExtension(e,t),this.registerRequiredExtension(e),this}},{key:"registerUsedExtension",value:function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(function(t){return t===e})||this.json.extensionsUsed.push(e)}},{key:"registerRequiredExtension",value:function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(function(t){return t===e})||this.json.extensionsRequired.push(e)}},{key:"removeExtension",value:function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}},{key:"setObjectExtension",value:function(e,t,r){(e.extensions||{})[t]=r}},{key:"addMesh",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n={primitives:[{attributes:this._addAttributes(e),indices:t,mode:r}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}},{key:"addPointCloud",value:function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}},{key:"addImage",value:function(e,t){t=t||G(e);var r={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(r),this.json.images.length-1}},{key:"addBufferView",value:function(e){var t=e.byteLength;O(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var r={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=H(t),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(e,t){var r={bufferView:e,type:w(t.size),componentType:t.componentType,count:t.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},r=this.addBufferView(e),n={size:t.size,componentType:C(e),count:Math.round(e.length/t.size)};return this.addAccessor(r,Object.assign(n,t))}},{key:"createBinaryChunk",value:function(){if(!this.arrayBuffer){for(var e=this.byteLength,t=new ArrayBuffer(e),r=new Uint8Array(t),n=0,i=0;i<this.sourceBuffers.length;i++){n=W(this.sourceBuffers[i],r,n)}this.json.buffers[0].byteLength=e,this.arrayBuffer=t,this.sourceBuffers=[]}}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}},{key:"json",get:function(){return this.gltf.json}}]),e}(),Y="KHR_draco_mesh_compression";function q(e){var t={};for(var r in e){var n=e[r];if("indices"!==r){var i=Z(n);t[r]=i}}return t}function Z(e,t){var r=function(e,t){var r=e,n=1,i=0;e&&e.value&&(r=e.value,n=e.size||1);r&&(ArrayBuffer.isView(r)||(r=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;if(Array.isArray(e))return new t(e);if(r&&!(e instanceof t))return new t(e);return e}(r,Float32Array)),i=r.length/n);return{buffer:r,size:n,count:i}}(e),n=r.buffer,i=r.size;return{value:n,size:i,bufferView:null,byteOffset:0,count:r.count,type:w(i),componentType:C(n)}}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function J(e){return!!e&&(Array.isArray(e)&&(e=e[0]),e.parseTextSync||e.parseSync||e.parse||e.loadAndParse||e.parseStream||e.parseInBatches||e.worker)}function $(e){var t;return R(J(e)),Array.isArray(e)&&(t=e[1],e=z({},e=e[0],{options:z({},e.options,{},t)})),e.extension&&(e.extensions=e.extensions||e.extension,delete e.extension),Array.isArray(e.extensions)||(e.extensions=[e.extensions]),R(e.extensions&&e.extensions.length>0&&e.extensions[0]),e.parseTextSync&&(e.text=!0),e.text||(e.binary=!0),e}var ee={};var te=/[^.]+$/;function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).nothrow,i=void 0!==n&&n;if(t=t||"",e&&!Array.isArray(e)){var s=e;return $(s),s}(function(e){var t=!0,r=!1,n=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;$(o)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}})(e=e||Object.values(ee)),t=t.replace(/\?.*/,"");var o=null;if(!(o=(o=o||function(e,t){var r=t.match(te),n=r&&r[0];return n&&function(e,t){t=t.toLowerCase();var r=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value,u=!0,c=!1,f=void 0;try{for(var l,h=a.extensions[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var E=l.value;if(E.toLowerCase()===t)return a}}catch(e){c=!0,f=e}finally{try{u||null==h.return||h.return()}finally{if(c)throw f}}}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}(e,n)}(e,t))||function(e,t){if(!t)return null;var r=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value;if("string"==typeof t){if(ne(t,a))return a}else if(ArrayBuffer.isView(t)){if(ie(t.buffer,t.byteOffset,a))return a}else if(t instanceof ArrayBuffer){if(ie(t,0,a))return a}}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}(e,r))){if(i)return null;throw new Error("No valid loader found for ".concat(t))}return o}function ne(e,t){return t.testText&&t.testText(e)}function ie(e,t,r){switch(Array.isArray(r.test)?"array":Object(l.a)(r.test)){case"function":return r.test(e,r);case"string":case"array":return(Array.isArray(r.test)?r.test:[r.test]).some(function(r){return r===function(e,t,r){if(e.byteLength<=t+r)return"";for(var n=new DataView(e),i="",s=0;s<r;s++)i+=String.fromCharCode(n.getUint8(t+s));return i}(e,t,r.length)});default:return!1}}var se=function(){function e(){p(this,e)}return A(e,[{key:"log",value:function(){}},{key:"info",value:function(){}},{key:"warn",value:function(){}},{key:"error",value:function(){}}]),e}();function oe(e,t){return null===(e=Object.assign({},t&&t.DEFAULT_OPTIONS,t&&t.defaultOptions,t&&t.options,e,{dataType:"arraybuffer"})).log&&(e.log=new se),"log"in e||(e.log=console),e}function ae(e){this.wrapped=e}function ue(e){var t,r;function n(t,r){try{var s=e[t](r),o=s.value,a=o instanceof ae;Promise.resolve(a?o.wrapped:o).then(function(e){a?n("next",e):i(s.done?"return":"normal",e)},function(e){n("throw",e)})}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new Promise(function(s,o){var a={key:e,arg:i,resolve:s,reject:o,next:null};r?r=r.next=a:(t=r=a,n(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(ue.prototype[Symbol.asyncIterator]=function(){return this}),ue.prototype.next=function(e){return this._invoke("next",e)},ue.prototype.throw=function(e){return this._invoke("throw",e)},ue.prototype.return=function(e){return this._invoke("return",e)};var ce=r(4);function fe(e){return le.apply(this,arguments)}function le(){return(le=f(a.a.mark(function e(t){var r,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=12;break}return r="fetch failed ".concat(t.status," "),e.prev=2,e.next=5,t.text();case 5:n=e.sent,r+=n,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:throw new Error(r);case 12:case"end":return e.stop()}},e,null,[[2,9]])}))).apply(this,arguments)}var he="Cannot convert supplied data type";function Ee(e,t){return h(e)?t=t||e.url:E(t)&&(t=t.name),"string"==typeof t?t.replace(/\?.*/,""):t}function _e(e,t){if(t.text&&"string"==typeof e)return e;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){var r=e.buffer||e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}throw new Error(he)}function ve(e,t){return Te.apply(this,arguments)}function Te(){return(Te=f(a.a.mark(function e(t,r){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(t=e.sent,n=t instanceof ArrayBuffer||ArrayBuffer.isView(t),"string"!=typeof t&&!n){e.next=6;break}return e.abrupt("return",_e(t,r));case 6:if(!E(t)){e.next=10;break}return e.next=9,g(t);case 9:t=e.sent;case 10:if(!h(t)){e.next=23;break}return e.next=13,fe(t);case 13:if(!r.binary){e.next=19;break}return e.next=16,t.arrayBuffer();case 16:e.t0=e.sent,e.next=22;break;case 19:return e.next=21,t.text();case 21:e.t0=e.sent;case 22:return e.abrupt("return",e.t0);case 23:throw new Error(he);case 24:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pe(e){return Buffer.isBuffer(e)?new Uint8Array(e).buffer:e}function ye(e){if(pe&&(e=pe(e)),e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer;if("string"==typeof e){var t=e;return(new TextEncoder).encode(t).buffer}return R(!1)}function Ae(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){if(e instanceof ArrayBuffer)r.push(e);else if(e.buffer&&e.buffer instanceof ArrayBuffer)r.push(e.buffer);else if(t&&"object"===Object(l.a)(e))for(var n in e)Ae(e[n],t,r)}else;return r}var Re=new Map;var de=0;function ge(e){var t=e.data;(0,e.resolve)(t)}var me=function(){function e(t){var r=t.source,n=t.name,i=void 0===n?"web-worker-".concat(de++):n,s=t.onMessage;p(this,e);var o=function(e){if(R("string"==typeof e,"worker source"),e.startsWith("url(")&&e.endsWith(")"))return e.match(/^url\((.*)\)$/)[1];var t=Re.get(e);if(!t){var r=new Blob([e],{type:"application/javascript"});t=URL.createObjectURL(r),Re.set(e,t)}return t}(r);this.worker=new Worker(o,{name:i}),this.name=i,this.onMessage=s||ge}return A(e,[{key:"process",value:function(){var e=f(a.a.mark(function e(t){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){r.worker.onmessage=function(t){return r.onMessage({worker:r.worker,data:t.data,resolve:e,reject:n})},r.worker.onerror=function(e){return n(e)};var i=Ae(t);r.worker.postMessage(t,i)}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.worker.terminate(),this.worker=null}}]),e}(),be=function(){function e(t){var r=t.source,n=t.name,i=void 0===n?"unnamed":n,s=t.maxConcurrency,o=void 0===s?1:s,a=t.onMessage,u=t.onDebug,c=void 0===u?function(){}:u;p(this,e),this.source=r,this.name=i,this.maxConcurrency=o,this.onMessage=a,this.onDebug=c,this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1}return A(e,[{key:"destroy",value:function(){this.idleQueue.forEach(function(e){return e.destroy()}),this.isDestroyed=!0}},{key:"process",value:function(){var e=f(a.a.mark(function e(t,r){var n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,i){n.jobQueue.push({data:t,jobName:r,resolve:e,reject:i}),n._startQueuedJob()}));case 1:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"_startQueuedJob",value:function(){var e=this;if(this.jobQueue.length){var t=this._getAvailableWorker();if(t){var r=this.jobQueue.shift();this.onDebug({message:"processing",worker:t.name,job:r.jobName,backlog:this.jobQueue.length}),t.process(r.data).then(function(e){return r.resolve(e)}).catch(function(e){return r.reject(e)}).then(function(){return e._onWorkerDone(t)})}}}},{key:"_onWorkerDone",value:function(e){this.isDestroyed?e.destroy():(this.idleQueue.push(e),this._startQueuedJob())}},{key:"_getAvailableWorker",value:function(){if(this.idleQueue.length>0)return this.idleQueue.shift();if(this.count<this.maxConcurrency){this.count++;var e="".concat(this.name.toLowerCase(),"-worker-").concat(this.count,"-of-").concat(this.maxConcurrency);return new me({source:this.source,onMessage:this.onMessage,name:e})}return null}}]),e}(),Oe=5,Se=function(){function e(t){var r=t.maxConcurrency,n=void 0===r?Oe:r,i=t.onMessage,s=t.onDebug,o=void 0===s?function(){}:s;p(this,e),this.maxConcurrency=n,this.onMessage=i,this.onDebug=o,this.workerPools=new Map}return A(e,[{key:"setProps",value:function(e){"maxConcurrency"in e&&(this.maxConcurrency=e.maxConcurrency),"onDebug"in e&&(this.onDebug=e.onDebug)}},{key:"destroy",value:function(){this.workerPools.forEach(function(e){return e.destroy()})}},{key:"process",value:function(){var e=f(a.a.mark(function e(t,r,n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._getWorkerPool(t,r),e.abrupt("return",i.process(n));case 2:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getWorkerPool",value:function(e,t){var r=this.workerPools.get(t);return r||(r=new be({source:e,name:t,onMessage:this.onMessage,maxConcurrency:this.maxConcurrency,onDebug:this.onDebug}),this.workerPools.set(t,r)),r}}]),e}(),Ne=null;function Me(e){return Ie.apply(this,arguments)}function Ie(){return(Ie=f(a.a.mark(function e(t){var r,n,i,s,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.worker,n=t.data,i=t.resolve,s=t.reject,e.t0=n.type,e.next="done"===e.t0?4:"process"===e.t0?6:"error"===e.t0?17:19;break;case 4:return i(n.result),e.abrupt("break",19);case 6:return e.prev=6,e.next=9,Fe(n.arraybuffer,n.options,n.url);case 9:o=e.sent,r.postMessage({type:"process-done",id:n.id,result:o},Ae(o)),e.next=16;break;case 13:e.prev=13,e.t1=e.catch(6),r.postMessage({type:"process-error",id:n.id,message:e.t1.message});case 16:return e.abrupt("break",19);case 17:return s(n.message),e.abrupt("break",19);case 19:case"end":return e.stop()}},e,null,[[6,13]])}))).apply(this,arguments)}function Le(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.maxConcurrency&&(t.maxConcurrency=e.maxConcurrency),e.onDebug&&(t.onDebug=e.onDebug),(Ne=Ne||new Se({onMessage:Me})).setProps(t),Ne}(n);return n=JSON.parse(JSON.stringify(n)),i.process(e,"loaders.gl-".concat(t),{arraybuffer:ye(r),options:n,source:"loaders.gl",type:"process"})}function we(e,t,r,n){return Ce.apply(this,arguments)}function Ce(){return(Ce=f(a.a.mark(function e(t,r,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve(t,r);case 2:if(t=e.sent,!r.parseTextSync||"string"!=typeof t){e.next=6;break}return n.dataType="text",e.abrupt("return",r.parseTextSync(t,n,i,r));case 6:if(!r.parse){e.next=10;break}return e.next=9,r.parse(t,n,i,r);case 9:return e.abrupt("return",e.sent);case 10:if(!r.parseSync){e.next=12;break}return e.abrupt("return",r.parseSync(t,n,i,r));case 12:if(!r.worker){e.next=16;break}return e.next=15,Le(r.worker,r.name,t,n);case 15:return e.abrupt("return",e.sent);case 16:return e.abrupt("return",R(!1));case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fe(e,t,r,n){return Be.apply(this,arguments)}function Be(){return(Be=f(a.a.mark(function e(t,r,n,i){var s,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return!r||Array.isArray(r)||J(r)||(i=n,n=r,r=null),n=n||{},s=Ee(t,i),o=re(r,s,t),n=oe(n,o),e.next=7,we(t,o,n,s);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var xe=a.a.mark(Ge);function ke(e,t,r){return Ue.apply(this,arguments)}function Ue(){return(Ue=f(a.a.mark(function e(t,r,n){var i,s,o,u,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.getObjectExtension(t,Y),s=r.getTypedArrayForBufferView(i.bufferView),o=new Uint8Array(s.buffer).subarray(s.byteOffset),u=new Uint8Array(o),e.next=6,Fe(u);case 6:c=e.sent,t.attributes=q(c.attributes),c.indices&&(t.indices=Z(c.indices)),De(t);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pe(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n.DracoWriter||!n.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var i=n.DracoWriter.encodeSync({attributes:e}),s=n.DracoLoader.parseSync({attributes:e}),o=n._addFauxAttributes(s.attributes),a=n.addBufferView(i);return{primitives:[{attributes:o,mode:r,extensions:u({},Y,{bufferView:a,attributes:o})}]}}function De(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function Ge(e){var t,r,n,i,s,o,u,c,f,l,h,E;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=!0,r=!1,n=void 0,a.prev=3,i=(e.json.meshes||[])[Symbol.iterator]();case 5:if(t=(s=i.next()).done){a.next=36;break}o=s.value,u=!0,c=!1,f=void 0,a.prev=10,l=o.primitives[Symbol.iterator]();case 12:if(u=(h=l.next()).done){a.next=19;break}return E=h.value,a.next=16,E;case 16:u=!0,a.next=12;break;case 19:a.next=25;break;case 21:a.prev=21,a.t0=a.catch(10),c=!0,f=a.t0;case 25:a.prev=25,a.prev=26,u||null==l.return||l.return();case 28:if(a.prev=28,!c){a.next=31;break}throw f;case 31:return a.finish(28);case 32:return a.finish(25);case 33:t=!0,a.next=5;break;case 36:a.next=42;break;case 38:a.prev=38,a.t1=a.catch(3),r=!0,n=a.t1;case 42:a.prev=42,a.prev=43,t||null==i.return||i.return();case 45:if(a.prev=45,!r){a.next=48;break}throw n;case 48:return a.finish(45);case 49:return a.finish(42);case 50:case"end":return a.stop()}},xe,null,[[3,38,42,50],[10,21,25,33],[26,,28,32],[43,,45,49]])}var je={KHR_draco_mesh_compression:function(){function e(){p(this,e)}return A(e,null,[{key:"decode",value:function(){var e=f(a.a.mark(function e(t){var r,n,i,s,o,u,c,f,l,h=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=h.length>1&&void 0!==h[1]?h[1]:{}).decompress){e.next=3;break}return e.abrupt("return");case 3:for(n=new K(t),i=[],s=!0,o=!1,u=void 0,e.prev=8,c=Ge(n)[Symbol.iterator]();!(s=(f=c.next()).done);s=!0)l=f.value,n.getObjectExtension(l,Y)&&i.push(ke(l,n,r));e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,u=e.t0;case 16:e.prev=16,e.prev=17,s||null==c.return||c.return();case 19:if(e.prev=19,!o){e.next=22;break}throw u;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=26,Promise.all(i);case 26:n.removeExtension(Y);case 27:case"end":return e.stop()}},e,null,[[8,12,16,24],[17,,19,23]])}));return function(t){return e.apply(this,arguments)}}()},{key:"decodeSync",value:function(e,t){if(t.decompress&&new K(e).getRequiredExtension(Y))throw new Error("Cannot synchronously decode Draco")}},{key:"encode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new K(e),n=!0,i=!1,s=void 0;try{for(var o,a=(r.json.meshes||[])[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){Pe(o.value,t),r.addRequiredExtension(Y)}}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}}},{key:"name",get:function(){return Y}}]),e}(),KHR_lights_punctual:function(){function e(){p(this,e)}return A(e,null,[{key:"decode",value:function(e,t){var r=new K(e),n=r.getExtension("KHR_lights_punctual");n&&(r.json.lights=n.lights,r.removeExtension("KHR_lights_punctual"));var i=!0,s=!1,o=void 0;try{for(var a,u=(r.nodes||[])[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value,f=c.extensions&&c.extensions.KHR_lights_punctual;f&&(c.light=r._get("lights",f.light),delete c.extensions.KHR_lights_punctual)}}catch(e){s=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}}},{key:"encode",value:function(e,t){var r=new K(e),n=r.json;if(n.lights){var i=r.addExtensions("KHR_lights_punctual");O(!i.lights),i.lights=n.lights,delete n.lights}if(r.json.lights){var s=!0,o=!1,a=void 0;try{for(var u,c=r.json.lights[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var f=u.value,l=f.node;r.addObjectExtension(l,"KHR_lights_punctual",f)}}catch(e){o=!0,a=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw a}}delete r.json.lights}}},{key:"name",get:function(){return"KHR_lights_punctual"}}]),e}()};function Ve(e,t){return Xe.apply(this,arguments)}function Xe(){return(Xe=f(a.a.mark(function e(t,r){var n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=a.a.keys(je);case 1:if((e.t1=e.t0()).done){e.next=10;break}if(n=e.t1.value,n in r&&!r[n]){e.next=8;break}return i=je[n],e.next=8,i.decode(t,r);case 8:e.next=1;break;case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function He(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var We,Ke=1735152710,Ye=12,qe=8,Ze=1313821514,Qe=5130562,ze=!0;function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new DataView(e),i=r.magic,s=void 0===i?Ke:i,o=n.getUint32(t,!1);return o===s||o===Ke}function $e(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=new DataView(t);e.type=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}(i,r+0),e.version=i.getUint32(r+4,ze);var s=i.getUint32(r+8,ze);return e.header={byteOffset:r,byteLength:s},"glTF"!==e.type&&console.warn("Invalid GLB magic string ".concat(e.type)),He(2===e.version,"Invalid GLB version ".concat(e.version,". Only .glb v2 supported")),He(e.header.byteLength>Ye+qe),e.json={},e.hasBinChunk=!1,e.binChunks=[],function(e,t,r,n){for(;r+8<=e.header.byteLength;){var i=t.getUint32(r+0,ze),s=t.getUint32(r+4,ze);switch(r+=qe,s){case Ze:et(e,t,r,i,n);break;case Qe:tt(e,t,r,i,n)}switch(s){case 0:n.strict||et(e,t,r,i,n);break;case 1:n.strict||tt(e,t,r,i,n)}r+=H(i)}}(e,i,r+12,n),function(e){e.byteOffset=e.header.byteOffset,e.magic=e.header.magic,e.version=e.header.version,e.byteLength=e.header.byteLength,e.hasBinChunk=e.binChunks.length>=1,e.binChunkByteOffset=e.header.hasBinChunk?e.binChunks[0].byteOffset:0,e.binChunkLength=e.header.hasBinChunk?e.binChunks[0].byteLength:0}(e),r+e.header.byteLength}function et(e,t,r,n,i){var s=new Uint8Array(t.buffer,r,n),o=new TextDecoder("utf8").decode(s);e.json=JSON.parse(o)}function tt(e,t,r,n,i){e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:r,byteLength:n,arrayBuffer:t.buffer})}function rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function nt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rt(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var it={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},st={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ot={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},at={magFilter:ot.TEXTURE_MAG_FILTER,minFilter:ot.TEXTURE_MIN_FILTER,wrapS:ot.TEXTURE_WRAP_S,wrapT:ot.TEXTURE_WRAP_T},ut=(u(We={},ot.TEXTURE_MAG_FILTER,ot.LINEAR),u(We,ot.TEXTURE_MIN_FILTER,ot.NEAREST_MIPMAP_LINEAR),u(We,ot.TEXTURE_WRAP_S,ot.REPEAT),u(We,ot.TEXTURE_WRAP_,ot.REPEAT),We);var ct=function(){function e(){p(this,e)}return A(e,[{key:"postProcess",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.json,n=e.buffers,i=void 0===n?[]:n,s=e.images,o=void 0===s?[]:s,a=e.baseUri,u=void 0===a?"":a;return O(r),this.baseUri=u,this.json=r,this.buffers=i,this.images=o,this._resolveTree(this.json,t),this.json}},{key:"_resolveTree",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.bufferViews&&(e.bufferViews=e.bufferViews.map(function(e,r){return t._resolveBufferView(e,r)})),e.images&&(e.images=e.images.map(function(e,n){return t._resolveImage(e,n,r)})),e.samplers&&(e.samplers=e.samplers.map(function(e,r){return t._resolveSampler(e,r)})),e.textures&&(e.textures=e.textures.map(function(e,r){return t._resolveTexture(e,r)})),e.accessors&&(e.accessors=e.accessors.map(function(e,r){return t._resolveAccessor(e,r)})),e.materials&&(e.materials=e.materials.map(function(e,r){return t._resolveMaterial(e,r)})),e.meshes&&(e.meshes=e.meshes.map(function(e,r){return t._resolveMesh(e,r)})),e.nodes&&(e.nodes=e.nodes.map(function(e,r){return t._resolveNode(e,r)})),e.skins&&(e.skins=e.skins.map(function(e,r){return t._resolveSkin(e,r)})),e.scenes&&(e.scenes=e.scenes.map(function(e,r){return t._resolveScene(e,r)})),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===Object(l.a)(t))return t;var r=this.json[e]&&this.json[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"_resolveScene",value:function(e,t){var r=this;return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map(function(e){return r.getNode(e)}),e}},{key:"_resolveNode",value:function(e,t){var r=this;return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map(function(e){return r.getNode(e)})),void 0!==e.mesh&&(e.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}},{key:"_resolveSkin",value:function(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}},{key:"_resolveMesh",value:function(e,t){var r=this;return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map(function(e){var t=(e=nt({},e)).attributes;for(var n in e.attributes={},t)e.attributes[n]=r.getAccessor(t[n]);return void 0!==e.indices&&(e.indices=r.getAccessor(e.indices)),void 0!==e.material&&(e.material=r.getMaterial(e.material)),e})),e}},{key:"_resolveMaterial",value:function(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture=nt({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=nt({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=nt({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.pbrMetallicRoughness){e.pbrMetallicRoughness=nt({},e.pbrMetallicRoughness);var r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture=nt({},r.baseColorTexture),r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture=nt({},r.metallicRoughnessTexture),r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}},{key:"_resolveAccessor",value:function(e,t){var r,n;return e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(r=e.componentType,st[r]),e.components=(n=e.type,it[n]),e.bytesPerElement=e.bytesPerComponent*e.components,e}},{key:"_resolveTexture",value:function(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):ut,e.source=this.getImage(e.source),e}},{key:"_resolveSampler",value:function(e,t){for(var r in e.id=e.id||"sampler-".concat(t),e.parameters={},e){var n=this._enumSamplerParameter(r);void 0!==n&&(e.parameters[n]=e[r])}return e}},{key:"_enumSamplerParameter",value:function(e){return at[e]}},{key:"_resolveImage",value:function(e,t,r){var n=this;if(e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),"uri"in e){var i=this.images[t];i&&i.image&&(e.image=i.image,delete e.uri);var s=r.uri||this.baseUri;if(s){var o=e.uri;e.uri=B(e.uri,s),e.originalUri=o,e.baseUri=s,e.fullUri=e.uri}}return e.getImageAsync=function(){return e.bufferView?new Promise(function(t){var r=n.getBufferView(e.bufferView),i=e.mimeType||"image/jpeg",s=new Blob([r.data],{type:i}),o=(self.URL||self.webkitURL).createObjectURL(s),a=new Image;a.onload=function(){return t(a)},a.src=o}):e.uri?new Promise(function(t){var r=new Image;r.crossOrigin="anonymous",r.onload=function(){return t(r)},r.src=e.fullUri||e.uri}):null},e}},{key:"_resolveBufferView",value:function(e,t){e.id=e.id||"bufferView-".concat(t);var r=e.buffer;e.buffer=this.getBuffer(r);var n=this.buffers[r].arrayBuffer,i=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(i+=e.byteOffset),e.data=new Uint8Array(n,i,e.byteLength),e}},{key:"_resolveCamera",value:function(e,t){return e.id=e.id||"camera-".concat(t),e.perspective,e.orthographic,e}}]),e}();function ft(e,t){return(new ct).postProcess(e,t)}function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ht(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Et={fetchLinkedResources:!0,fetchImages:!1,createImages:!1,fetch:m,decompress:!1,DracoLoader:null,postProcess:!1,log:console};function _t(e,t){return vt.apply(this,arguments)}function vt(){return(vt=f(a.a.mark(function e(t,r){var n,i,s,o,u,c=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>2&&void 0!==c[2]?c[2]:0,i=c.length>3&&void 0!==c[3]?c[3]:{},i=ht({},Et,{},i),pt(t,r,n,i),s=[],i.fetchImages&&(o=Rt(t,i),s.push(o)),!i.fetchLinkedResources){e.next=9;break}return e.next=9,yt(t,i);case 9:return u=Ve(t,i),s.push(u),e.next=13,Promise.all(s);case 13:return e.abrupt("return",i.postProcess?ft(t,i):t);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Tt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return pt(e,t,r,n=ht({},Et,{},n)),n.fetchLinkedResources&&function(e,t){var r=!0,n=!1,i=void 0;try{for(var s,o=(e.json.buffers||[])[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value;if(a.uri)throw new Error("parseGLTFSync: Cannot decode uri buffers")}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}(e),n.decodeExtensions&&function(e,t){for(var r in je)r in t&&!t[r]||je[r].decodeSync(e,t)}(e,n),n.postProcess?ft(e,n):e}function pt(e,t,r,n){(n.uri&&(e.baseUri=n.uri),t instanceof ArrayBuffer&&!Je(t,r,n))&&(t=(new TextDecoder).decode(t));"string"==typeof t?e.json=JSON.parse(t):t instanceof ArrayBuffer?(e._glb={},r=$e(e._glb,t,r,n),e.json=e._glb.json):e.json=t;var i=e.json.buffers||[];e.buffers=new Array(i.length).fill({}),e._glb&&e._glb.hasBinChunk&&(e.buffers[0]={arrayBuffer:e._glb.binChunks[0].arrayBuffer,byteOffset:e._glb.binChunks[0].byteOffset,byteLength:e._glb.binChunks[0].byteLength},e.json.buffers[0].data=e.buffers[0].arrayBuffer,e.json.buffers[0].byteOffset=e.buffers[0].byteOffset);var s=e.json.images||[];e.images=new Array(s.length).fill({})}function yt(e,t){return At.apply(this,arguments)}function At(){return(At=f(a.a.mark(function e(t,r){var n,i,s,o,u,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.json.buffers.length)){e.next=19;break}if(i=t.json.buffers[n],r.uri||console.warn("options.uri must be set to decode embedded glTF buffers"),!i.uri||!r.uri){e.next=16;break}return O(s=r.fetch||window.fetch),o=B(i.uri,r.uri),e.next=10,s(o);case 10:return u=e.sent,e.next=13,u.arrayBuffer();case 13:c=e.sent,t.buffers[n]={arrayBuffer:c,byteOffset:0,byteLength:c.byteLength},delete i.uri;case 16:++n,e.next=1;break;case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rt(e,t){return dt.apply(this,arguments)}function dt(){return(dt=f(a.a.mark(function e(t,r){var n,i,s,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.json.images||[],i=[],s=0;s<n.length;++s)"uri"in(o=n[s])&&i.push(gt(t,o,s,r));return e.next=5,Promise.all(i);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gt(e,t,r,n){return mt.apply(this,arguments)}function mt(){return(mt=f(a.a.mark(function e(t,r,n,i){var s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return O(i.fetch||window.fetch),s=B(r.uri,i.uri),e.next=5,new Promise(function(e,t){var r=new Image;r.crossOrigin="anonymous",r.onload=function(){return e(r)},r.onerror=function(e){return t(e)},r.src=s});case 5:t.images[n]=e.sent;case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}ce.a.TextEncoder;var bt=ce.a.TextDecoder;function Ot(e,t){return function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var s=t;var o=function(e,t){var r=function(e){if("string"==typeof e){if(0===e.indexOf("##/"))return e.slice(1);var t=e.match(/#\/([a-z]+)\/([0-9]+)/);if(t){var r=parseInt(t[2],10);return[t[1],r]}if(t=e.match(/\$\$\$([0-9]+)/)){var n=parseInt(t[1],10);return["accessors",n]}}return null}(e);if(r){var n=x(r,2),i=n[0],s=n[1],o=t[i]&&t[i][s];if(o)return o;console.error("Invalid JSON pointer ".concat(e,": #/").concat(i,"/").concat(s))}return null}(s,n);if(o)return o;if(Array.isArray(s))return s.map(function(t){return e(t,r,n,i)});if(null!==s&&"object"===Object(l.a)(s)){var a={};for(var u in s)a[u]=e(s[u],r,n,i);return a}return s}(e,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function St(e,t,r){r&&(e=function(e,t){for(var r=e.byteLength-t,n=new ArrayBuffer(r),i=new Uint8Array(e),s=new Uint8Array(n),o=0;o<r;o++)s[o]=i[t+o];return n}(e,r));for(var n=t.bufferViews||[],i=0;i<n.length;++i){O(n[i].byteLength>=0)}return{accessors:Nt(e,n,t),images:Mt(e,n,t)}}function Nt(e,t,r){for(var n=r.accessors||[],i=[],s=0;s<n.length;++s){var o=n[s];O(o);var a=t[o.bufferView];if(a){var u=F(o,a),c=u.ArrayType,f=u.length,l=new c(e,a.byteOffset,f);l.accessor=o,i.push(l)}}return i}function Mt(e,t,r){for(var n=r.images||[],i=[],s=0;s<n.length;++s){var o=n[s];O(o);var a=t[o.bufferView];O(a);var u=new Uint8Array(e,a.byteOffset,a.byteLength);u.imate=o,i.push(u)}return i}var It,Lt=function(){function e(){p(this,e)}return A(e,[{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.parseSync(e,t)}},{key:"parseSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.glbArrayBuffer=e,this.binaryByteOffset=null,this.packedJson=null,this.json=null,null===this.json&&null===this.binaryByteOffset){$e(this,this.glbArrayBuffer,0,t),this.binaryByteOffset=this.binChunkByteOffset,this.packedJson=this.json;var r=St(this.glbArrayBuffer,this.json,this.binaryByteOffset);this.json=Ot(this.json,r),this.unpackedBuffers=r}return this}},{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getJSON",value:function(){return this.json}},{key:"getArrayBuffer",value:function(){return this.glbArrayBuffer}},{key:"getBinaryByteOffset",value:function(){return this.binaryByteOffset}},{key:"getBufferView",value:function(e){var t=(e.byteOffset||0)+this.binaryByteOffset;return new Uint8Array(this.glbArrayBuffer,t,e.byteLength)}},{key:"getBuffer",value:function(e){var t=L[e.componentType],r=M[e.type],n=I[e.componentType],i=e.count*r,s=e.count*r*n,o=this.json.bufferViews[e.bufferView];O(s>=0&&e.byteOffset+s<=o.byteLength);var a=o.byteOffset+this.binaryByteOffset+e.byteOffset;return new t(this.glbArrayBuffer,a,i)}},{key:"getImageData",value:function(e){return{typedArray:this.getBufferView(e.bufferView),mimeType:e.mimeType||"image/jpeg"}}},{key:"getImage",value:function(e){var t=this.getBufferView(e.bufferView),r=e.mimeType||"image/jpeg",n=new Blob([t],{type:r}),i=(self.URL||self.webkitURL).createObjectURL(n),s=new Image;return s.src=i,s}},{key:"getImageAsync",value:function(e){var t=this;return new Promise(function(r){var n=t.getBufferView(e.bufferView),i=e.mimeType||"image/jpeg",s=new Blob([n],{type:i}),o=(self.URL||self.webkitURL).createObjectURL(s),a=new Image;a.onload=function(){return r(a)},a.src=o})}}],[{key:"isGLB",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Je(e,0)}}]),e}(),wt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ct={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ft={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Bt={magFilter:Ft.TEXTURE_MAG_FILTER,minFilter:Ft.TEXTURE_MIN_FILTER,wrapS:Ft.TEXTURE_WRAP_S,wrapT:Ft.TEXTURE_WRAP_T},xt=(u(It={},Ft.TEXTURE_MAG_FILTER,Ft.LINEAR),u(It,Ft.TEXTURE_MIN_FILTER,Ft.NEAREST_MIPMAP_LINEAR),u(It,Ft.TEXTURE_WRAP_S,Ft.REPEAT),u(It,Ft.TEXTURE_WRAP_,Ft.REPEAT),It);var kt=function(){function e(){p(this,e)}return A(e,[{key:"postProcess",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.gltf=e,this.glbParser=t,this._resolveToTree(r),this.gltf}},{key:"_resolveToTree",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.gltf;return(r.bufferViews||[]).forEach(function(t,r){return e._resolveBufferView(t,r)}),(r.images||[]).forEach(function(r,n){return e._resolveImage(r,n,t)}),(r.samplers||[]).forEach(function(t,r){return e._resolveSampler(t,r)}),(r.textures||[]).forEach(function(t,r){return e._resolveTexture(t,r)}),(r.accessors||[]).forEach(function(t,r){return e._resolveAccessor(t,r)}),(r.materials||[]).forEach(function(t,r){return e._resolveMaterial(t,r)}),(r.meshes||[]).forEach(function(t,r){return e._resolveMesh(t,r)}),(r.nodes||[]).forEach(function(t,r){return e._resolveNode(t,r)}),(r.skins||[]).forEach(function(t,r){return e._resolveSkin(t,r)}),(r.scenes||[]).forEach(function(t,r){return e._resolveScene(t,r)}),void 0!==r.scene&&(r.scene=r.scenes[this.gltf.scene]),this._process_extension_KHR_lights_punctual(),r}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===Object(l.a)(t))return t;var r=this.gltf[e]&&this.gltf[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"_resolveScene",value:function(e,t){var r=this;e.id="scene-".concat(t),e.nodes=(e.nodes||[]).map(function(e){return r.getNode(e)})}},{key:"_resolveNode",value:function(e,t){var r=this;e.id="node-".concat(t),e.children=(e.children||[]).map(function(e){return r.getNode(e)}),void 0!==e.mesh&&(e.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin))}},{key:"_resolveSkin",value:function(e,t){e.id="skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices)}},{key:"_resolveMesh",value:function(e,t){e.id="mesh-".concat(t);var r=!0,n=!1,i=void 0;try{for(var s,o=e.primitives[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value;for(var u in a.attributes)a.attributes[u]=this.getAccessor(a.attributes[u]);void 0!==a.indices&&(a.indices=this.getAccessor(a.indices)),void 0!==a.material&&(a.material=this.getMaterial(a.material))}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"_resolveMaterial",value:function(e,t){if(e.id="material-".concat(t),e.normalTexture&&(e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.pbrMetallicRoughness){var r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}}},{key:"_resolveAccessor",value:function(e,t){e.id="accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=Ct[e],e.components=wt[e],e.bytesPerElement=e.bytesPerComponent*e.components}},{key:"_resolveTexture",value:function(e,t){e.id="texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):xt,e.source=this.getImage(e.source)}},{key:"_resolveSampler",value:function(e,t){for(var r in e.id="sampler-".concat(t),e.parameters={},e){var n=this._enumSamplerParameter(r);void 0!==n&&(e.parameters[n]=e[r])}}},{key:"_enumSamplerParameter",value:function(e){return Bt[e]}},{key:"_resolveImage",value:function(e,t,r){var n=this;e.id="image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var i=r.createImages;void 0===i||i?e.image=this.glbParser.getImage(e):e.getImageAsync=function(){return n.glbParser?n.glbParser.getImageAsync(e):e.uri?new Promise(function(t){var n=new Image;n.crossOrigin="anonymous",n.onload=function(){return t(n)},n.src=B(e.uri,r.uri)}):null}}},{key:"_resolveBufferView",value:function(e,t){if(e.id="bufferView-".concat(t),e.buffer=this.getBuffer(e.buffer),this.glbParser)e.data=this.glbParser.getBufferView(e);else{var r=e.byteOffset||0;e.data=new Uint8Array(e.buffer.data,r,e.byteLength)}}},{key:"_resolveCamera",value:function(e){e.perspective,e.orthographic}},{key:"_process_extension_KHR_lights_punctual",value:function(){var e=this.gltf,t=e.extensions&&e.extensions.KHR_lights_punctual;t&&(e.lights=t.lights),this._removeExtension("KHR_lights_punctual");var r=!0,n=!1,i=void 0;try{for(var s,o=(e.nodes||[])[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value,u=a.extensions&&a.extensions.KHR_lights_punctual;u&&(a.light=this._get("lights",u.light),delete a.extensions.KHR_lights_punctual)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}delete e.lights}},{key:"_removeExtension",value:function(e){this.gltf.extensionsRequired&&this._removeStringFromArray(this.gltf.extensionsRequired,e),this.gltf.extensionsUsed&&this._removeStringFromArray(this.gltf.extensionsUsed,e),this.gltf.extensions&&delete this.gltf.extensions[e]}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}}]),e}();function Ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ut(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ut(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Dt={fetchLinkedResources:!0,fetch:m,decompress:!1,DracoLoader:null,postProcess:!0,createImages:!1,log:console},Gt=function(){function e(){p(this,e)}return A(e,[{key:"parse",value:function(){var e=f(a.a.mark(function e(t){var r,n=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&void 0!==n[1]?n[1]:{},r=Object.assign({},Dt,r),this.parseSync(t,Pt({},r,{postProcess:!1,decompress:!1})),!r.fetchLinkedResources){e.next=6;break}return e.next=6,this._loadLinkedAssets(r);case 6:return r.decompress&&this._decompressMeshes(r),r.postProcess&&(new kt).postProcess(this.gltf,this.glbParser,r),e.abrupt("return",this.gltf);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t=Object.assign({},Dt,t),e instanceof ArrayBuffer&&!Lt.isGLB(e,t))&&(e=(new bt).decode(e));("string"==typeof e&&(e=JSON.parse(e)),e instanceof ArrayBuffer?(this.glbParser=new Lt,this.gltf=this.glbParser.parseSync(e).json,this.json=this.gltf):(this.glbParser=null,this.gltf=e,this.json=e),t.decompress&&this._decompressMeshes(t),t.postProcess)&&(new kt).postProcess(this.gltf,this.glbParser,t);return this.gltf}},{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getExtraData",value:function(e){return(this.json.extras||{})[e]}},{key:"getExtension",value:function(e){var t=this.getUsedExtensions().find(function(t){return t===e}),r=this.json.extensions||{};return t?r[e]||!0:null}},{key:"getRequiredExtension",value:function(e){return this.getRequiredExtensions().find(function(t){return t===e})?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===Object(l.a)(t))return t;var r=this.gltf[e]&&this.gltf[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"_loadLinkedAssets",value:function(){var e=f(a.a.mark(function e(t){var r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.gltf.buffers.map(function(e){return r._loadBuffer(e,t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_loadBuffer",value:function(){var e=f(a.a.mark(function e(t,r){var n,i,s,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.uri||!r.uri){e.next=11;break}return n=r.fetch||window.fetch,i=B(t.uri,r.uri),e.next=5,n(i);case 5:return s=e.sent,e.next=8,s.arrayBuffer();case 8:o=e.sent,t.data=o,t.uri=null;case 11:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"_decompressMeshes",value:function(e){if(e.DracoLoader&&e.decompress){var t=!0,r=!1,n=void 0;try{for(var i,s=(this.gltf.meshes||[])[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value,a=!0,u=!1,c=void 0;try{for(var f,l=o.primitives[Symbol.iterator]();!(a=(f=l.next()).done);a=!0){var h=f.value;if(this._decompressKhronosDracoPrimitive(h,e),this._decompressUberDracoPrimitive(h,e),!h.attributes||0===Object.keys(h.attributes).length)throw new Error("Empty glTF primitive: decompression failure?")}}catch(e){u=!0,c=e}finally{try{a||null==l.return||l.return()}finally{if(u)throw c}}}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}this._removeExtension(Y),this._removeExtension("UBER_draco_point_cloud_compression")}}},{key:"_decompressKhronosDracoPrimitive",value:function(e,t){var r=e.extensions&&e.extensions[Y];if(r){delete e.extensions[Y];var n=this._getBufferViewArray(r.bufferView),i=t.DracoLoader.parseSync(n);e.attributes=q(i.attributes),i.indices&&(e.indices=Z(i.indices))}}},{key:"_decompressUberDracoPrimitive",value:function(e,t){var r=e.extensions&&e.extensions.UBER_draco_point_cloud_compression;if(r){if(0!==e.mode)throw new Error("UBER_draco_point_cloud_compression");delete e.extensions.UBER_draco_point_cloud_compression;var n=this._getBufferViewArray(r.bufferView),i=t.DracoLoader.parseSync(n);e.attributes=i.attributes}}},{key:"_getBufferViewArray",value:function(e){var t=this.gltf.bufferViews[e];if(this.glbParser)return this.glbParser.getBufferView(t);var r=this.gltf.buffers[t.buffer].data,n=t.byteOffset||0;return new Uint8Array(r,n,t.byteLength)}},{key:"_removeExtension",value:function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}}]),e}();function jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jt(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jt(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Xt={gltf:{parserVersion:1},uri:""};function Ht(){return(Ht=f(a.a.mark(function e(t){var r,n,i,s,o,u=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},2===(r=Vt({},Xt,{},r)).gltf.parserVersion||!1===r.useGLTFParser){e.next=5;break}return n=new Gt,e.abrupt("return",n.parse(t,r));case 5:return i=r.byteOffset,s=void 0===i?0:i,o={},e.next=9,_t(o,t,s,r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Wt={name:"glTF",extensions:["gltf","glb"],text:!0,binary:!0,test:"glTF",parse:function(e){return Ht.apply(this,arguments)},parseSync:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(2!==(t=Vt({},Xt,{},t)).gltf.parserVersion&&!1!==t.useGLTFParser)return(new Gt).parseSync(e,t);var r=t.byteOffset;return Tt({},e,void 0===r?0:r,t)},defaultOptions:Xt};function Kt(e,t){return!t||"object"!==Object(l.a)(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yt(e){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}function Qt(e,t,r){return(Qt=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&qt(i,r.prototype),i}).apply(null,arguments)}function zt(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}Math.PI,Math.PI;var Jt={};function $t(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,r=void 0===t?Jt.precision||4:t;return e=function(e){return Math.round(e/Jt.EPSILON)*Jt.EPSILON}(e),"".concat(parseFloat(e.toPrecision(r)))}function er(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&void 0!==e.length}function tr(e,t,r){var n=Jt.EPSILON;r&&(Jt.EPSILON=r);try{if(e===t)return!0;if(er(e)&&er(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!tr(e[i],t[i]))return!1;return!0}return e&&"object"===Object(l.a)(e)&&e.equals?e.equals(t):t&&"object"===Object(l.a)(t)&&t.equals?t.equals(e):Math.abs(e-t)<=Jt.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{Jt.EPSILON=n}}function rr(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function nr(e,t,r){if(Jt.debug&&!function(e,t){if(e.length!==t)return!1;for(var r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(""|r," some fields set to invalid numbers'"));return e}Jt.EPSILON=1e-12,Jt.debug=!1,Jt.precision=4,Jt.printTypes=!1,Jt.printDegrees=!1,Jt.printRowMajor=!0;var ir={};function sr(e,t){ir[e]||(ir[e]=!0,console.warn("".concat(e," has been removed in version ").concat(t,", see upgrade guide for more information")))}function or(e){var t="function"==typeof Map?new Map:void 0;return(or=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Qt(e,arguments,Yt(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),qt(n,e)})(e)}var ar=function(e){function t(){return p(this,t),Kt(this,Yt(t).apply(this,arguments))}return Zt(t,or(Array)),A(t,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}},{key:"to",value:function(e){return e===this?this:er(e)?this.toArray(e):this.toObject(e)}},{key:"toTarget",value:function(e){return e?this.to(e):this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(Jt)}},{key:"formatString",value:function(e){for(var t="",r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+$t(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}},{key:"equals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(!tr(this[t],e[t]))return!1;return!0}},{key:"exactEquals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}},{key:"negate",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}},{key:"lerp",value:function(e,t,r){void 0===r&&(r=t,t=e,e=this);for(var n=0;n<this.ELEMENTS;++n){var i=e[n];this[n]=i+r*(t[n]-i)}return this.check()}},{key:"min",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}},{key:"max",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}},{key:"clamp",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var s=i[n],o=0;o<this.ELEMENTS;++o)this[o]+=s[o];return this.check()}},{key:"subtract",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var s=i[n],o=0;o<this.ELEMENTS;++o)this[o]-=s[o];return this.check()}},{key:"scale",value:function(e){if(Array.isArray(e))return this.multiply(e);for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"sub",value:function(e){return this.subtract(e)}},{key:"setScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}},{key:"addScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}},{key:"subScalar",value:function(e){return this.addScalar(-e)}},{key:"multiplyScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"divideScalar",value:function(e){return this.scale(1/e)}},{key:"clampScalar",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}},{key:"multiplyByScalar",value:function(e){return this.scale(e)}},{key:"check",value:function(){if(Jt.debug&&!this.validate(this))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var e=this.length===this.ELEMENTS,t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}},{key:"elements",get:function(){return this}}]),t}(),ur=function(e){function t(){return p(this,t),Kt(this,Yt(t).apply(this,arguments))}return Zt(t,ar),A(t,[{key:"toString",value:function(){var e="[";if(Jt.printRowMajor){e+="row-major:";for(var t=0;t<this.RANK;++t)for(var r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+t])}else{e+="column-major:";for(var n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]"}},{key:"getElementIndex",value:function(e,t){return t*this.RANK+e}},{key:"getElement",value:function(e,t){return this[t*this.RANK+e]}},{key:"setElement",value:function(e,t,r){return this[t*this.RANK+e]=rr(r),this}},{key:"getColumn",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),r=e*this.RANK,n=0;n<this.RANK;++n)t[n]=this[r+n];return t}},{key:"setColumn",value:function(e,t){for(var r=e*this.RANK,n=0;n<this.RANK;++n)this[r+n]=t[n];return this}}]),t}();var cr=1e-6,fr="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function lr(e,t,r){var n=t[0],i=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],E=t[10],_=t[11],v=t[12],T=t[13],p=t[14],y=t[15],A=r[0],R=r[1],d=r[2],g=r[3];return e[0]=A*n+R*a+d*l+g*v,e[1]=A*i+R*u+d*h+g*T,e[2]=A*s+R*c+d*E+g*p,e[3]=A*o+R*f+d*_+g*y,A=r[4],R=r[5],d=r[6],g=r[7],e[4]=A*n+R*a+d*l+g*v,e[5]=A*i+R*u+d*h+g*T,e[6]=A*s+R*c+d*E+g*p,e[7]=A*o+R*f+d*_+g*y,A=r[8],R=r[9],d=r[10],g=r[11],e[8]=A*n+R*a+d*l+g*v,e[9]=A*i+R*u+d*h+g*T,e[10]=A*s+R*c+d*E+g*p,e[11]=A*o+R*f+d*_+g*y,A=r[12],R=r[13],d=r[14],g=r[15],e[12]=A*n+R*a+d*l+g*v,e[13]=A*i+R*u+d*h+g*T,e[14]=A*s+R*c+d*E+g*p,e[15]=A*o+R*f+d*_+g*y,e}function hr(e,t,r){var n=r[0],i=r[1],s=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}var Er,_r;Er=new fr(2),fr!=Float32Array&&(Er[0]=0,Er[1]=0),_r=Er;function vr(){var e=new fr(3);return fr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Tr(e,t,r){var n=new fr(3);return n[0]=e,n[1]=t,n[2]=r,n}function pr(e,t){var r=t[0],n=t[1],i=t[2],s=r*r+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function yr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ar(e,t,r){var n=t[0],i=t[1],s=t[2],o=r[0],a=r[1],u=r[2];return e[0]=i*u-s*a,e[1]=s*o-n*u,e[2]=n*a-i*o,e}var Rr=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)};!function(){var e=vr()}();function dr(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function gr(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}!function(){var e=function(){var e=new fr(4);return fr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();var mr=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),br=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Or=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Sr={},Nr=function(e){function t(e){var r;return p(this,t),r=Kt(this,Yt(t).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(e)?r.copy(e):r.identity(),r}return Zt(t,ur),A(t,[{key:"INDICES",get:function(){return Or}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return Sr.IDENTITY=Sr.IDENTITY||Object.freeze(new t(mr)),Sr.IDENTITY}},{key:"ZERO",get:function(){return Sr.ZERO=Sr.ZERO||Object.freeze(new t(br)),Sr.ZERO}}]),A(t,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}},{key:"set",value:function(e,t,r,n,i,s,o,a,u,c,f,l,h,E,_,v){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this[9]=c,this[10]=f,this[11]=l,this[12]=h,this[13]=E,this[14]=_,this[15]=v,this.check()}},{key:"setRowMajor",value:function(e,t,r,n,i,s,o,a,u,c,f,l,h,E,_,v){return this[0]=e,this[1]=i,this[2]=u,this[3]=h,this[4]=t,this[5]=s,this[6]=c,this[7]=E,this[8]=r,this[9]=o,this[10]=f,this[11]=_,this[12]=n,this[13]=a,this[14]=l,this[15]=v,this.check()}},{key:"toRowMajor",value:function(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}},{key:"identity",value:function(){return this.copy(mr)}},{key:"fromQuaternion",value:function(e){return function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=r+r,a=n+n,u=i+i,c=r*o,f=n*o,l=n*a,h=i*o,E=i*a,_=i*u,v=s*o,T=s*a,p=s*u;e[0]=1-l-_,e[1]=f+p,e[2]=h-T,e[3]=0,e[4]=f-p,e[5]=1-c-_,e[6]=E+v,e[7]=0,e[8]=h+T,e[9]=E-v,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}},{key:"frustum",value:function(e){var r=e.left,n=e.right,i=e.bottom,s=e.top,o=e.near,a=e.far;return a===1/0?t._computeInfinitePerspectiveOffCenter(this,r,n,i,s,o):function(e,t,r,n,i,s,o){var a=1/(r-t),u=1/(i-n),c=1/(s-o);e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*u,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(i+n)*u,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0}(this,r,n,i,s,o,a),this.check()}},{key:"lookAt",value:function(e,t,r){if(1===arguments.length){var n=e;e=n.eye,t=n.center,r=n.up}return function(e,t,r,n){var i,s,o,a,u,c,f,l,h,E,_=t[0],v=t[1],T=t[2],p=n[0],y=n[1],A=n[2],R=r[0],d=r[1],g=r[2];Math.abs(_-R)<cr&&Math.abs(v-d)<cr&&Math.abs(T-g)<cr?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(f=_-R,l=v-d,h=T-g,i=y*(h*=E=1/Math.sqrt(f*f+l*l+h*h))-A*(l*=E),s=A*(f*=E)-p*h,o=p*l-y*f,(E=Math.sqrt(i*i+s*s+o*o))?(i*=E=1/E,s*=E,o*=E):(i=0,s=0,o=0),a=l*o-h*s,u=h*i-f*o,c=f*s-l*i,(E=Math.sqrt(a*a+u*u+c*c))?(a*=E=1/E,u*=E,c*=E):(a=0,u=0,c=0),e[0]=i,e[1]=a,e[2]=f,e[3]=0,e[4]=s,e[5]=u,e[6]=l,e[7]=0,e[8]=o,e[9]=c,e[10]=h,e[11]=0,e[12]=-(i*_+s*v+o*T),e[13]=-(a*_+u*v+c*T),e[14]=-(f*_+l*v+h*T),e[15]=1)}(this,e,t=t||[0,0,0],r=r||[0,1,0]),this.check()}},{key:"ortho",value:function(e){var t=e.left,r=e.right,n=e.bottom,i=e.top,s=e.near,o=void 0===s?.1:s,a=e.far;return function(e,t,r,n,i,s,o){var a=1/(t-r),u=1/(n-i),c=1/(s-o);e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*a,e[13]=(i+n)*u,e[14]=(o+s)*c,e[15]=1}(this,t,r,n,i,o,void 0===a?500:a),this.check()}},{key:"orthographic",value:function(e){var r=e.fovy,n=void 0===r?45*Math.PI/180:r,i=e.aspect,s=void 0===i?1:i,o=e.focalDistance,a=void 0===o?1:o,u=e.near,c=void 0===u?.1:u,f=e.far,l=void 0===f?500:f;if(n>2*Math.PI)throw Error("radians");var h=n/2,E=a*Math.tan(h),_=E*s;return(new t).ortho({left:-_,right:_,bottom:-E,top:E,near:c,far:l})}},{key:"perspective",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fovy,r=e.fov,n=void 0===r?45*Math.PI/180:r,i=e.aspect,s=void 0===i?1:i,o=e.near,a=void 0===o?.1:o,u=e.far,c=void 0===u?500:u;if((t=t||n)>2*Math.PI)throw Error("radians");return function(e,t,r,n,i){var s,o=1/Math.tan(t/2);e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(s=1/(n-i),e[10]=(i+n)*s,e[14]=2*i*n*s):(e[10]=-1,e[14]=-2*n)}(this,t,s,a,c),this.check()}},{key:"determinant",value:function(){return t=(e=this)[0],r=e[1],n=e[2],i=e[3],s=e[4],o=e[5],a=e[6],u=e[7],c=e[8],f=e[9],l=e[10],h=e[11],E=e[12],_=e[13],v=e[14],T=e[15],(t*o-r*s)*(l*T-h*v)-(t*a-n*s)*(f*T-h*_)+(t*u-i*s)*(f*v-l*_)+(r*a-n*o)*(c*T-h*E)-(r*u-i*o)*(c*v-l*E)+(n*u-i*a)*(c*_-f*E);var e,t,r,n,i,s,o,a,u,c,f,l,h,E,_,v,T}},{key:"getScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}},{key:"getTranslation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}},{key:"getRotation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(t||[-0,-0,-0]),n=1/r[0],i=1/r[1],s=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*n,e[5]=this[5]*i,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*n,e[9]=this[9]*i,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{key:"getRotationMatrix3",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(t||[-0,-0,-0]),n=1/r[0],i=1/r[1],s=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=this[4]*n,e[4]=this[5]*i,e[5]=this[6]*s,e[6]=this[8]*n,e[7]=this[9]*i,e[8]=this[10]*s,e}},{key:"transpose",value:function(){return function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}},{key:"invert",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],E=t[11],_=t[12],v=t[13],T=t[14],p=t[15],y=r*a-n*o,A=r*u-i*o,R=r*c-s*o,d=n*u-i*a,g=n*c-s*a,m=i*c-s*u,b=f*v-l*_,O=f*T-h*_,S=f*p-E*_,N=l*T-h*v,M=l*p-E*v,I=h*p-E*T,L=y*I-A*M+R*N+d*S-g*O+m*b;L&&(L=1/L,e[0]=(a*I-u*M+c*N)*L,e[1]=(i*M-n*I-s*N)*L,e[2]=(v*m-T*g+p*d)*L,e[3]=(h*g-l*m-E*d)*L,e[4]=(u*S-o*I-c*O)*L,e[5]=(r*I-i*S+s*O)*L,e[6]=(T*R-_*m-p*A)*L,e[7]=(f*m-h*R+E*A)*L,e[8]=(o*M-a*S+c*b)*L,e[9]=(n*S-r*M-s*b)*L,e[10]=(_*g-v*R+p*y)*L,e[11]=(l*R-f*g-E*y)*L,e[12]=(a*O-o*N-u*b)*L,e[13]=(r*N-n*O+i*b)*L,e[14]=(v*A-_*d-T*y)*L,e[15]=(f*d-l*A+h*y)*L)}(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return lr(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return lr(this,this,e),this.check()}},{key:"rotateX",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[4],o=t[5],a=t[6],u=t[7],c=t[8],f=t[9],l=t[10],h=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*n,e[5]=o*i+f*n,e[6]=a*i+l*n,e[7]=u*i+h*n,e[8]=c*i-s*n,e[9]=f*i-o*n,e[10]=l*i-a*n,e[11]=h*i-u*n}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],o=t[1],a=t[2],u=t[3],c=t[8],f=t[9],l=t[10],h=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*n,e[1]=o*i-f*n,e[2]=a*i-l*n,e[3]=u*i-h*n,e[8]=s*n+c*i,e[9]=o*n+f*i,e[10]=a*n+l*i,e[11]=u*n+h*i}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,r){var n=Math.sin(r),i=Math.cos(r),s=t[0],o=t[1],a=t[2],u=t[3],c=t[4],f=t[5],l=t[6],h=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*n,e[1]=o*i+f*n,e[2]=a*i+l*n,e[3]=u*i+h*n,e[4]=c*i-s*n,e[5]=f*i-o*n,e[6]=l*i-a*n,e[7]=h*i-u*n}(this,this,e),this.check()}},{key:"rotateXYZ",value:function(e){var t=x(e,3),r=t[0],n=t[1],i=t[2];return this.rotateX(r).rotateY(n).rotateZ(i)}},{key:"rotateAxis",value:function(e,t){return function(e,t,r,n){var i,s,o,a,u,c,f,l,h,E,_,v,T,p,y,A,R,d,g,m,b,O,S,N,M=n[0],I=n[1],L=n[2],w=Math.sqrt(M*M+I*I+L*L);w<cr||(M*=w=1/w,I*=w,L*=w,i=Math.sin(r),o=1-(s=Math.cos(r)),a=t[0],u=t[1],c=t[2],f=t[3],l=t[4],h=t[5],E=t[6],_=t[7],v=t[8],T=t[9],p=t[10],y=t[11],A=M*M*o+s,R=I*M*o+L*i,d=L*M*o-I*i,g=M*I*o-L*i,m=I*I*o+s,b=L*I*o+M*i,O=M*L*o+I*i,S=I*L*o-M*i,N=L*L*o+s,e[0]=a*A+l*R+v*d,e[1]=u*A+h*R+T*d,e[2]=c*A+E*R+p*d,e[3]=f*A+_*R+y*d,e[4]=a*g+l*m+v*b,e[5]=u*g+h*m+T*b,e[6]=c*g+E*m+p*b,e[7]=f*g+_*m+y*b,e[8]=a*O+l*S+v*N,e[9]=u*O+h*S+T*N,e[10]=c*O+E*S+p*N,e[11]=f*O+_*S+y*N,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?hr(this,this,e):hr(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){return function(e,t,r){var n,i,s,o,a,u,c,f,l,h,E,_,v=r[0],T=r[1],p=r[2];t===e?(e[12]=t[0]*v+t[4]*T+t[8]*p+t[12],e[13]=t[1]*v+t[5]*T+t[9]*p+t[13],e[14]=t[2]*v+t[6]*T+t[10]*p+t[14],e[15]=t[3]*v+t[7]*T+t[11]*p+t[15]):(n=t[0],i=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],E=t[10],_=t[11],e[0]=n,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=u,e[6]=c,e[7]=f,e[8]=l,e[9]=h,e[10]=E,e[11]=_,e[12]=n*v+a*T+l*p+t[12],e[13]=i*v+u*T+h*p+t[13],e[14]=s*v+c*T+E*p+t[14],e[15]=o*v+f*T+_*p+t[15])}(this,this,e),this.check()}},{key:"transform",value:function(e,t){return 4===e.length?(nr(t=function(e,t,r){var n=t[0],i=t[1],s=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*s+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*s+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*s+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*s+r[15]*o,e}(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}},{key:"transformAsPoint",value:function(e,t){switch(e.length){case 2:t=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}(t||[-0,-0],e,this);break;case 3:t=function(e,t,r){var n=t[0],i=t[1],s=t[2],o=r[3]*n+r[7]*i+r[11]*s+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*s+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*s+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*s+r[14])/o,e}(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return nr(t,e.length),t}},{key:"transformAsVector",value:function(e,t){switch(e.length){case 2:t=function(e,t,r){var n=t[0],i=t[1],s=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/s,e[1]=(r[1]*n+r[5]*i)/s,e}(t||[-0,-0],e,this);break;case 3:t=function(e,t,r){var n=t[0],i=t[1],s=t[2],o=r[3]*n+r[7]*i+r[11]*s||1;return e[0]=(r[0]*n+r[4]*i+r[8]*s)/o,e[1]=(r[1]*n+r[5]*i+r[9]*s)/o,e[2]=(r[2]*n+r[6]*i+r[10]*s)/o,e}(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return nr(t,e.length),t}},{key:"makeRotationX",value:function(e){return this.identity().rotateX(e)}},{key:"makeTranslation",value:function(e,t,r){return this.identity().translate([e,t,r])}},{key:"transformPoint",value:function(e,t){return sr("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}},{key:"transformVector",value:function(e,t){return sr("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}},{key:"transformDirection",value:function(e,t){return sr("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(e,t,r,n,i,s){var o=2*s/(r-t),a=2*s/(i-n),u=(r+t)/(r-t),c=(i+n)/(i-n),f=-2*s;return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=u,e[9]=c,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=f,e[15]=0,e}}]),t}();function Mr(){var e=new fr(4);return fr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ir(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function Lr(e,t,r){var n=t[0],i=t[1],s=t[2],o=t[3],a=r[0],u=r[1],c=r[2],f=r[3];return e[0]=n*f+o*a+i*c-s*u,e[1]=i*f+o*u+s*a-n*c,e[2]=s*f+o*c+n*u-i*a,e[3]=o*f-n*a-i*u-s*c,e}function wr(e,t,r,n){var i,s,o,a,u,c=t[0],f=t[1],l=t[2],h=t[3],E=r[0],_=r[1],v=r[2],T=r[3];return(s=c*E+f*_+l*v+h*T)<0&&(s=-s,E=-E,_=-_,v=-v,T=-T),1-s>cr?(i=Math.acos(s),o=Math.sin(i),a=Math.sin((1-n)*i)/o,u=Math.sin(n*i)/o):(a=1-n,u=n),e[0]=a*c+u*E,e[1]=a*f+u*_,e[2]=a*l+u*v,e[3]=a*h+u*T,e}function Cr(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*s+s]-t[3*o+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*s+o]-t[3*o+s])*r,e[s]=(t[3*s+i]+t[3*i+s])*r,e[o]=(t[3*o+i]+t[3*i+o])*r}return e}var Fr,Br,xr,kr,Ur,Pr,Dr=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},Gr=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},jr=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},Vr=function(e,t,r,n){var i=t[0],s=t[1],o=t[2],a=t[3];return e[0]=i+n*(r[0]-i),e[1]=s+n*(r[1]-s),e[2]=o+n*(r[2]-o),e[3]=a+n*(r[3]-a),e},Xr=dr,Hr=gr,Wr=function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=r*r+n*n+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=s*o,e},Kr=(Fr=vr(),Br=Tr(1,0,0),xr=Tr(0,1,0),function(e,t,r){var n=yr(t,r);return n<-.999999?(Ar(Fr,Br,t),Rr(Fr)<1e-6&&Ar(Fr,xr,t),pr(Fr,Fr),Ir(e,Fr,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Ar(Fr,t,r),e[0]=Fr[0],e[1]=Fr[1],e[2]=Fr[2],e[3]=1+n,Wr(e,e))}),Yr=(kr=Mr(),Ur=Mr(),Pr=function(){var e=new fr(9);return fr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}(),[0,0,0,1]),qr=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return p(this,t),e=Kt(this,Yt(t).call(this,-0,-0,-0,-0)),Array.isArray(r)&&1===arguments.length?e.copy(r):e.set(r,n,i,s),e}return Zt(t,ar),A(t,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}},{key:"set",value:function(e,t,r,n){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this.check()}},{key:"fromMatrix3",value:function(e){return Cr(this,e),this.check()}},{key:"identity",value:function(){return function(e){e[0]=0,e[1]=0,e[2]=0,e[3]=1}(this),this.check()}},{key:"fromAxisRotation",value:function(e,t){return Ir(this,e,t),this.check()}},{key:"setAxisAngle",value:function(e,t){return this.fromAxisRotation(e,t)}},{key:"len",value:function(){return Xr(this)}},{key:"lengthSquared",value:function(e){return Hr(this)}},{key:"dot",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return jr(this,e)}},{key:"rotationTo",value:function(e,t){return Kr(this,e,t),this.check()}},{key:"add",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return Dr(this,this,e),this.check()}},{key:"calculateW",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2];e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i))}(this,this),this.check()}},{key:"conjugate",value:function(){return function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(this,this),this.check()}},{key:"invert",value:function(){return function(e,t){var r=t[0],n=t[1],i=t[2],s=t[3],o=r*r+n*n+i*i+s*s,a=o?1/o:0;e[0]=-r*a,e[1]=-n*a,e[2]=-i*a,e[3]=s*a}(this,this),this.check()}},{key:"lerp",value:function(e,t,r){return Vr(this,e,t,r),this.check()}},{key:"multiplyRight",value:function(e,t){return zt(!t),Lr(this,this,e),this.check()}},{key:"multiplyLeft",value:function(e,t){return zt(!t),Lr(this,e,this),this.check()}},{key:"normalize",value:function(){var e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}},{key:"rotateX",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(r),u=Math.cos(r);e[0]=n*u+o*a,e[1]=i*u+s*a,e[2]=s*u-i*a,e[3]=o*u-n*a}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(r),u=Math.cos(r);e[0]=n*u-s*a,e[1]=i*u+o*a,e[2]=s*u+n*a,e[3]=o*u-i*a}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(r),u=Math.cos(r);e[0]=n*u+i*a,e[1]=i*u-n*a,e[2]=s*u+o*a,e[3]=o*u-s*a}(this,this,e),this.check()}},{key:"scale",value:function(e){return Gr(this,this,e),this.check()}},{key:"slerp",value:function(e,t,r){switch(arguments.length){case 1:var n=arguments[0],i=n.start;e=void 0===i?Yr:i,t=n.target,r=n.ratio;break;case 2:var s=Array.prototype.slice.call(arguments);t=s[0],r=s[1],e=this}return wr(this,e,t,r),this.check()}},{key:"transformVector4",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return function(e,t,r){var n=t[0],i=t[1],s=t[2],o=r[0],a=r[1],u=r[2],c=r[3],f=c*n+a*s-u*i,l=c*i+u*n-o*s,h=c*s+o*i-a*n,E=-o*n-a*i-u*s;e[0]=f*c+E*-o+l*-u-h*-a,e[1]=l*c+E*-a+h*-o-f*-u,e[2]=h*c+E*-u+f*-a-l*-o,e[3]=t[3]}(t,e,this),nr(t,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(e,t){return this.setAxisAngle(e,t)}},{key:"premultiply",value:function(e,t){return this.multiplyLeft(e,t)}},{key:"multiply",value:function(e,t){return this.multiplyRight(e,t)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=rr(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=rr(e)}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=rr(e)}},{key:"w",get:function(){return this[3]},set:function(e){return this[3]=rr(e)}}]),t}();const Zr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qr={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function zr(e){if(!e._animation){const t=Qr[e.componentType],r=Zr[e.type],n=r*e.count,{buffer:i,byteOffset:s}=e.bufferView.data,o=new t(i,s+(e.byteOffset||0),n);if(1===r)e._animation=Array.from(o);else{const t=[];for(let e=0;e<o.length;e+=r)t.push(Array.from(o.slice(e,e+r)));e._animation=t}}return e._animation}const Jr=new Nr;const $r=new qr;function en(e,{input:t,interpolation:r,output:i},s,o){const a=e%t[t.length-1],u=t.findIndex(e=>e>=a),c=Math.max(0,u-1);if(!Array.isArray(s[o]))switch(o){case"translation":s[o]=[0,0,0];break;case"rotation":s[o]=[0,0,0,1];break;case"scale":s[o]=[1,1,1];break;default:n.log.warn(`Bad animation path ${o}`)()}Object(n.assert)(s[o].length===i[c].length);const f=t[c],l=t[u];switch(r){case"STEP":!function(e,t,r){for(let n=0;n<r.length;n++)e[t][n]=r[n]}(s,o,i[c]);break;case"LINEAR":if(l>f){const e=(a-f)/(l-f);!function(e,t,r,n,i){if("rotation"===t){$r.slerp({start:r,target:n,ratio:i});for(let r=0;r<$r.length;r++)e[t][r]=$r[r]}else for(let s=0;s<r.length;s++)e[t][s]=i*n[s]+(1-i)*r[s]}(s,o,i[c],i[u],e)}break;case"CUBICSPLINE":if(l>f){const e=(a-f)/(l-f),t=l-f;!function(e,t,{p0:r,outTangent0:n,inTangent1:i,p1:s,tDiff:o,ratio:a}){for(let u=0;u<e[t].length;u++){const c=n[u]*o,f=i[u]*o;e[t][u]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*r[u]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[u]+(Math.pow(a,3)-Math.pow(a,2))*f}}(s,o,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*u+0],p1:i[3*u+1],tDiff:t,ratio:e})}break;default:n.log.warn(`Interpolation ${r} not supported`)()}}class tn{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,Object.assign(this,e)}animate(e){if(!this.playing)return;const t=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:e,target:r,path:n})=>{en(t,e,r,n),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){const r=Jr.fromQuaternion(e.rotation);t.matrix.multiplyRight(r)}e.scale&&t.matrix.scale(e.scale)}(r,r._node)})}}class rn{constructor(e){this.animations=e.animations.map((t,r)=>{const n=t.name||`Animation-${r}`,i=t.samplers.map(({input:t,interpolation:r="LINEAR",output:n})=>({input:zr(e.accessors[t]),interpolation:r,output:zr(e.accessors[n])})),s=t.channels.map(({sampler:t,target:r})=>({sampler:i[t],target:e.nodes[r.node],path:r.path}));return new tn({name:n,channels:s})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class nn{constructor(e,{attributes:t,material:r,pbrDebug:n,imageBasedLightingEnvironment:i,lights:s,useTangents:o}){this.gl=e,this.defines={USE_TEX_LOD:1,MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],i&&(this.uniforms.u_DiffuseEnvSampler=i.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=i.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=i.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),n&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&o,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(i,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(n,"PBR_DEBUG"),r&&this.parseMaterial(r)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,r=null){const i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=new n.Texture2D(this.gl,{id:e.name||e.id,parameters:i,pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},data:e.texture.source.getImageAsync()});this.uniforms[t]=s,this.defineIfPresent(r,r),this.generatedTextures.push(s)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,r]}parseMaterial(e){if(e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(n.log.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}const sn="\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n",on="\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n";function an(e,t){return Object(n.isWebGL2)(e)?`#version 300 es\n${t}`:t}const un={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},cn={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class fn{constructor(e,t={}){this.gl=e,this.options=Object.assign({},cn,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(e=>this.createScene(e))}createAnimator(){return Array.isArray(this.gltf.animations)?new rn(this.gltf):null}createScene(e){const t=(e.nodes||[]).map(e=>this.createNode(e));return new n.GroupNode({id:e.name||e.id,children:t})}createNode(e){if(!e._node){const t=(e.children||[]).map(e=>this.createNode(e));e.mesh&&t.push(this.createMesh(e.mesh));const r=new n.GroupNode({id:e.name||e.id,children:t});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const t=(new Nr).fromQuaternion(e.rotation);r.matrix.multiplyRight(t)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const t=(e.primitives||[]).map((t,r)=>this.createPrimitive(t,r,e)),r=new n.GroupNode({id:e.name||e.id,children:t});e._mesh=r}return e._mesh}getVertexCount(e){n.log.warn("getVertexCount() not found")()}createPrimitive(e,t,r){return function(e,t){const{id:r,drawMode:i,vertexCount:s,attributes:o,modelOptions:a}=t,u=new nn(e,t);n.log.info(4,"createGLTFModel defines: ",u.defines)();const c=[];c.push(...u.generatedTextures),c.push(...Object.values(o).map(e=>e.buffer));const f=new n.ModelNode(e,Object.assign({id:r,drawMode:i,vertexCount:s,modules:[n.pbr],defines:u.defines,parameters:u.parameters,vs:an(e,sn),fs:an(e,on),managedResources:c},a));return f.setProps({attributes:o}),f.setUniforms(u.uniforms),f}(this.gl,Object.assign({id:e.name||`${r.name||r.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const r={};return Object.keys(e).forEach(t=>{r[t]=this.createAccessor(e[t],this.createBuffer(e[t],this.gl.ARRAY_BUFFER))}),t&&(r.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),n.log.info(4,"glTF Attributes",{attributes:e,indices:t,generated:r})(),r}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[t]||(r.lumaBuffers[t]=new n.Buffer(this.gl,{id:`from-${r.id}`,data:r.data||e.value,target:t})),r.lumaBuffers[t]}createAccessor(e,t){return new n._Accessor({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:un[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function ln(e,t,r){const n=new fn(e,r);return{scenes:n.instantiate(t),animator:n.createAnimator()}}var hn={name:"GLTF Scenegraph Loader",extensions:["gltf","glb"],parse:async function(e,t,r,i){Object(n.assert)(t.gl);const s=await Wt.parse(e,{...t,uri:r,decompress:!0}),o=ln(t.gl,s,t);return t.waitForFullLoad&&await async function(e){const t=[];return e.scenes.forEach(e=>{e.traverse(e=>{Object.values(e.model.program.uniforms).forEach(e=>{!1===e.loaded&&t.push(e)})})}),await async function(e){for(;e();)await new Promise(e=>window.requestAnimationFrame(e))}(()=>t.some(e=>!e.loaded))}(o),Object.assign({gltf:s},o)}},En=r(3),_n=r.n(En),vn=r(6);vn.a._parseImageNode;function Tn(e,t){if(vn.a._parseImageNode){var r=j(e).mimeType;return vn.a._parseImageNode(e,r,t)}return function(e,t){if("undefined"==typeof createImageBitmap)throw new Error("parseImage");var r=new Blob([new Uint8Array(e)]);return createImageBitmap(r)}(e)}function pn(e){return yn.apply(this,arguments)}function yn(){return(yn=f(a.a.mark(function e(t){var r,n,i,s=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:{},"undefined"!=typeof Image){e.next=9;break}return e.next=4,fetch(t,r);case 4:return n=e.sent,e.next=7,n.arrayBuffer();case 7:return i=e.sent,e.abrupt("return",Tn(i,r));case 9:return e.next=11,An(t,r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function An(e,t){return Rn.apply(this,arguments)}function Rn(){return(Rn=f(a.a.mark(function e(t,r){var n,i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!/\.svg((\?|#).*)?$/.test(t)){e.next=10;break}return e.next=3,fetch(t,r);case 3:return i=e.sent,e.next=6,i.text();case 6:s=e.sent,n="data:image/svg+xml;base64,".concat(btoa(s)),e.next=13;break;case 10:return e.next=12,t;case 12:n=e.sent;case 13:return e.next=15,new Promise(function(e,i){try{var s=new Image;s.onload=function(){return e(s)},s.onerror=function(e){return i(new Error("Could not load image ".concat(t,": ").concat(e)))},s.crossOrigin=r&&r.crossOrigin||"anonymous",s.src=n}catch(e){i(e)}});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}class dn{constructor(e,{brdfLutUrl:t,getTexUrl:r,specularMipLevels:n=10}){this.gl=e,this.brdfLutUrl=t,this.getTexUrl=r,this.specularMipLevels=n}makeCube({id:e,getTextureForFace:t,parameters:r}){const i={};return n.TextureCube.FACES.forEach(e=>{i[e]=t(e)}),new n.TextureCube(this.gl,{id:e,mipmaps:!1,parameters:r,pixels:i})}getDiffuseEnvSampler(){return this._DiffuseEnvSampler||(this._DiffuseEnvSampler=this.makeCube({id:"DiffuseEnvSampler",getTextureForFace:e=>pn(this.getTexUrl("diffuse",e,0)),parameters:{[_n.a.TEXTURE_WRAP_S]:_n.a.CLAMP_TO_EDGE,[_n.a.TEXTURE_WRAP_T]:_n.a.CLAMP_TO_EDGE,[_n.a.TEXTURE_MIN_FILTER]:_n.a.LINEAR,[_n.a.TEXTURE_MAG_FILTER]:_n.a.LINEAR}})),this._DiffuseEnvSampler}getSpecularEnvSampler(){return this._SpecularEnvSampler||(this._SpecularEnvSampler=this.makeCube({id:"SpecularEnvSampler",getTextureForFace:e=>{const t=[];for(let r=0;r<=this.specularMipLevels-1;r++)t.push(pn(this.getTexUrl("specular",e,r)));return t},parameters:{[_n.a.TEXTURE_WRAP_S]:_n.a.CLAMP_TO_EDGE,[_n.a.TEXTURE_WRAP_T]:_n.a.CLAMP_TO_EDGE,[_n.a.TEXTURE_MIN_FILTER]:_n.a.LINEAR_MIPMAP_LINEAR,[_n.a.TEXTURE_MAG_FILTER]:_n.a.LINEAR}})),this._SpecularEnvSampler}getBrdfTexture(){return this._BrdfTexture||(this._BrdfTexture=new n.Texture2D(this.gl,{id:"brdfLUT",parameters:{[_n.a.TEXTURE_WRAP_S]:_n.a.CLAMP_TO_EDGE,[_n.a.TEXTURE_WRAP_T]:_n.a.CLAMP_TO_EDGE,[_n.a.TEXTURE_MIN_FILTER]:_n.a.LINEAR,[_n.a.TEXTURE_MAG_FILTER]:_n.a.LINEAR},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},data:pn(this.brdfLutUrl)})),this._BrdfTexture}delete(){this._DiffuseEnvSampler&&(this._DiffuseEnvSampler.delete(),this._DiffuseEnvSampler=null),this._SpecularEnvSampler&&(this._SpecularEnvSampler.delete(),this._SpecularEnvSampler=null),this._BrdfTexture&&(this._BrdfTexture.delete(),this._BrdfTexture=null)}}let gn=1,mn=1;class bn{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:r=Number.POSITIVE_INFINITY,rate:n=1,repeat:i=1}=e,s=gn++,o={time:0,delay:t,duration:r,rate:n,repeat:i};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[t,r]of this.animations)r.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const e of t)this._setChannelTime(e,this.time);const r=this.animations.values();for(const e of r){const{animation:t,channel:r}=e;t.setTime(this.getTime(r))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const r=mn++;return this.animations.set(r,{animation:e,channel:t}),e.setTime(this.getTime(t)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const r=t-e.delay;r>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}class On{constructor(e){this._lastTime=-1,this.startIndex=-1,this.endIndex=-1,this.factor=0,this.times=[],this.values=[],this.setKeyFrames(e),this.setTime(0)}setKeyFrames(e){const t=e.length;this.times.length=t,this.values.length=t;for(let r=0;r<t;++r)this.times[r]=e[r][0],this.values[r]=e[r][1];this._calculateKeys(this._lastTime)}setTime(e){(e=Math.max(0,e))!==this._lastTime&&(this._calculateKeys(e),this._lastTime=e)}getStartTime(){return this.times[this.startIndex]}getEndTime(){return this.times[this.endIndex]}getStartData(){return this.values[this.startIndex]}getEndData(){return this.values[this.endIndex]}_calculateKeys(e){let t=0;const r=this.times.length;for(t=0;t<r-2&&!(this.times[t+1]>e);++t);this.startIndex=t,this.endIndex=t+1;const n=this.times[this.startIndex],i=this.times[this.endIndex];this.factor=Math.min(Math.max(0,(e-n)/(i-n)),1)}}function Sn(){throw new Error("@luma.gl/addons: `addEvents` is removed. Use `EventManager` from mjolnir.js instead.")}r.d(t,"Display",function(){return i}),r.d(t,"VRDisplay",function(){return s}),r.d(t,"GLTFScenegraphLoader",function(){return hn}),r.d(t,"GLTFEnvironment",function(){return dn}),r.d(t,"createGLTFObjects",function(){return ln}),r.d(t,"Timeline",function(){return bn}),r.d(t,"KeyFrames",function(){return On}),r.d(t,"addEvents",function(){return Sn})}])});